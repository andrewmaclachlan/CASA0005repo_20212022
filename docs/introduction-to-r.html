<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Introduction to R | CASA0005 Geographic Information Systems and Science</title>
  <meta name="description" content="The CASA0005 Geographic Information Systems and Science practical book" />
  <meta name="generator" content="bookdown 0.27 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Introduction to R | CASA0005 Geographic Information Systems and Science" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://andrewmaclachlan.github.io/CASA0005repo//general_images/casa_logo.png" />
  <meta property="og:description" content="The CASA0005 Geographic Information Systems and Science practical book" />
  <meta name="github-repo" content="andrewmaclachlan/CASA0005repo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Introduction to R | CASA0005 Geographic Information Systems and Science" />
  
  <meta name="twitter:description" content="The CASA0005 Geographic Information Systems and Science practical book" />
  <meta name="twitter:image" content="https://andrewmaclachlan.github.io/CASA0005repo//general_images/casa_logo.png" />

<meta name="author" content="Andy MacLachlan and Adam Dennett" />


<meta name="date" content="2022-06-17" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  <link rel="apple-touch-icon-precomposed" sizes="120x120" href="assets/apple-touch-icon.png" />
  <link rel="shortcut icon" href="assets/favicon.ico" type="image/x-icon" />
<link rel="prev" href="geographic-information.html"/>
<link rel="next" href="spatial-descriptive-statistics.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.23/datatables.js"></script>
<link href="libs/dt-core-1.11.3/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.11.3/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.11.3/js/jquery.dataTables.min.js"></script>
<link href="libs/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet" />
<script src="libs/nouislider-7.0.10/jquery.nouislider.min.js"></script>
<link href="libs/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet" />
<script src="libs/selectize-0.12.0/selectize.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<script src="libs/plotly-binding-4.10.0/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.5.1/plotly-latest.min.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.1.1/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.1.1/leaflet-providers-plugin.js"></script>
<script src="libs/clipboard-0.0.1/setClipboardText.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-151934476-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-151934476-1');
</script>
<script src="assets/book.js"></script>

<script>
/* ========================================================================
 * Bootstrap: transition.js v3.3.7
 * http://getbootstrap.com/javascript/#transitions
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // CSS TRANSITION SUPPORT (Shoutout: http://www.modernizr.com/)
  // ============================================================

  function transitionEnd() {
    var el = document.createElement('bootstrap')

    var transEndEventNames = {
      WebkitTransition : 'webkitTransitionEnd',
      MozTransition    : 'transitionend',
      OTransition      : 'oTransitionEnd otransitionend',
      transition       : 'transitionend'
    }

    for (var name in transEndEventNames) {
      if (el.style[name] !== undefined) {
        return { end: transEndEventNames[name] }
      }
    }

    return false // explicit for ie8 (  ._.)
  }

  // http://blog.alexmaccaw.com/css-transitions
  $.fn.emulateTransitionEnd = function (duration) {
    var called = false
    var $el = this
    $(this).one('bsTransitionEnd', function () { called = true })
    var callback = function () { if (!called) $($el).trigger($.support.transition.end) }
    setTimeout(callback, duration)
    return this
  }

  $(function () {
    $.support.transition = transitionEnd()

    if (!$.support.transition) return

    $.event.special.bsTransitionEnd = {
      bindType: $.support.transition.end,
      delegateType: $.support.transition.end,
      handle: function (e) {
        if ($(e.target).is(this)) return e.handleObj.handler.apply(this, arguments)
      }
    }
  })

}(jQuery);
</script>
<script>
/* ========================================================================
 * Bootstrap: collapse.js v3.3.7
 * http://getbootstrap.com/javascript/#collapse
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* jshint latedef: false */

+function ($) {
  'use strict';

  // COLLAPSE PUBLIC CLASS DEFINITION
  // ================================

  var Collapse = function (element, options) {
    this.$element      = $(element)
    this.options       = $.extend({}, Collapse.DEFAULTS, options)
    this.$trigger      = $('[data-toggle="collapse"][href="#' + element.id + '"],' +
                           '[data-toggle="collapse"][data-target="#' + element.id + '"]')
    this.transitioning = null

    if (this.options.parent) {
      this.$parent = this.getParent()
    } else {
      this.addAriaAndCollapsedClass(this.$element, this.$trigger)
    }

    if (this.options.toggle) this.toggle()
  }

  Collapse.VERSION  = '3.3.7'

  Collapse.TRANSITION_DURATION = 350

  Collapse.DEFAULTS = {
    toggle: true
  }

  Collapse.prototype.dimension = function () {
    var hasWidth = this.$element.hasClass('width')
    return hasWidth ? 'width' : 'height'
  }

  Collapse.prototype.show = function () {
    if (this.transitioning || this.$element.hasClass('in')) return

    var activesData
    var actives = this.$parent && this.$parent.children('.panel').children('.in, .collapsing')

    if (actives && actives.length) {
      activesData = actives.data('bs.collapse')
      if (activesData && activesData.transitioning) return
    }

    var startEvent = $.Event('show.bs.collapse')
    this.$element.trigger(startEvent)
    if (startEvent.isDefaultPrevented()) return

    if (actives && actives.length) {
      Plugin.call(actives, 'hide')
      activesData || actives.data('bs.collapse', null)
    }

    var dimension = this.dimension()

    this.$element
      .removeClass('collapse')
      .addClass('collapsing')[dimension](0)
      .attr('aria-expanded', true)

    this.$trigger
      .removeClass('collapsed')
      .attr('aria-expanded', true)

    this.transitioning = 1

    var complete = function () {
      this.$element
        .removeClass('collapsing')
        .addClass('collapse in')[dimension]('')
      this.transitioning = 0
      this.$element
        .trigger('shown.bs.collapse')
    }

    if (!$.support.transition) return complete.call(this)

    var scrollSize = $.camelCase(['scroll', dimension].join('-'))

    this.$element
      .one('bsTransitionEnd', $.proxy(complete, this))
      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)[dimension](this.$element[0][scrollSize])
  }

  Collapse.prototype.hide = function () {
    if (this.transitioning || !this.$element.hasClass('in')) return

    var startEvent = $.Event('hide.bs.collapse')
    this.$element.trigger(startEvent)
    if (startEvent.isDefaultPrevented()) return

    var dimension = this.dimension()

    this.$element[dimension](this.$element[dimension]())[0].offsetHeight

    this.$element
      .addClass('collapsing')
      .removeClass('collapse in')
      .attr('aria-expanded', false)

    this.$trigger
      .addClass('collapsed')
      .attr('aria-expanded', false)

    this.transitioning = 1

    var complete = function () {
      this.transitioning = 0
      this.$element
        .removeClass('collapsing')
        .addClass('collapse')
        .trigger('hidden.bs.collapse')
    }

    if (!$.support.transition) return complete.call(this)

    this.$element
      [dimension](0)
      .one('bsTransitionEnd', $.proxy(complete, this))
      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)
  }

  Collapse.prototype.toggle = function () {
    this[this.$element.hasClass('in') ? 'hide' : 'show']()
  }

  Collapse.prototype.getParent = function () {
    return $(this.options.parent)
      .find('[data-toggle="collapse"][data-parent="' + this.options.parent + '"]')
      .each($.proxy(function (i, element) {
        var $element = $(element)
        this.addAriaAndCollapsedClass(getTargetFromTrigger($element), $element)
      }, this))
      .end()
  }

  Collapse.prototype.addAriaAndCollapsedClass = function ($element, $trigger) {
    var isOpen = $element.hasClass('in')

    $element.attr('aria-expanded', isOpen)
    $trigger
      .toggleClass('collapsed', !isOpen)
      .attr('aria-expanded', isOpen)
  }

  function getTargetFromTrigger($trigger) {
    var href
    var target = $trigger.attr('data-target')
      || (href = $trigger.attr('href')) && href.replace(/.*(?=#[^\s]+$)/, '') // strip for ie7

    return $(target)
  }


  // COLLAPSE PLUGIN DEFINITION
  // ==========================

  function Plugin(option) {
    return this.each(function () {
      var $this   = $(this)
      var data    = $this.data('bs.collapse')
      var options = $.extend({}, Collapse.DEFAULTS, $this.data(), typeof option == 'object' && option)

      if (!data && options.toggle && /show|hide/.test(option)) options.toggle = false
      if (!data) $this.data('bs.collapse', (data = new Collapse(this, options)))
      if (typeof option == 'string') data[option]()
    })
  }

  var old = $.fn.collapse

  $.fn.collapse             = Plugin
  $.fn.collapse.Constructor = Collapse


  // COLLAPSE NO CONFLICT
  // ====================

  $.fn.collapse.noConflict = function () {
    $.fn.collapse = old
    return this
  }


  // COLLAPSE DATA-API
  // =================

  $(document).on('click.bs.collapse.data-api', '[data-toggle="collapse"]', function (e) {
    var $this   = $(this)

    if (!$this.attr('data-target')) e.preventDefault()

    var $target = getTargetFromTrigger($this)
    var data    = $target.data('bs.collapse')
    var option  = data ? 'toggle' : $this.data()

    Plugin.call($target, option)
  })

}(jQuery);
</script>
<script>
window.initializeCodeFolding = function(show) {

  // handlers for show-all and hide all
  $("#rmd-show-all-code").click(function() {
    // close the dropdown menu when an option is clicked
    $("#allCodeButton").dropdown("toggle");
    $('div.r-code-collapse').each(function() {
      $(this).collapse('show');
    });
  });
  $("#rmd-hide-all-code").click(function() {
    // close the dropdown menu when an option is clicked
    $("#allCodeButton").dropdown("toggle");
    $('div.r-code-collapse').each(function() {
      $(this).collapse('hide');
    });
  });

  // index for unique code element ids
  var currentIndex = 1;

  // select all R code blocks
  var rCodeBlocks = $('pre.sourceCode, pre.r, pre.python, pre.bash, pre.sql, pre.cpp, pre.stan');
  rCodeBlocks.each(function() {

    // if code block has been labeled with class `fold-show`, show the code on init!
    var classList = $(this).attr('class').split(/\s+/);
    for (var i = 0; i < classList.length; i++) {
    if (classList[i] === 'fold-show') {
        show = true;
      }
    }

    // create a collapsable div to wrap the code in
    var div = $('<div class="collapse r-code-collapse"></div>');
    if (show)
      div.addClass('in');
    var id = 'rcode-643E0F36' + currentIndex++;
    div.attr('id', id);
    $(this).before(div);
    $(this).detach().appendTo(div);

    // add a show code button right above
    var showCodeText = $('<span>' + (show ? 'Hide' : 'Code') + '</span>');
    var showCodeButton = $('<button type="button" class="btn btn-default btn-xs code-folding-btn pull-right"></button>');
    showCodeButton.append(showCodeText);
    showCodeButton
        .attr('data-toggle', 'collapse')
        .attr('data-target', '#' + id)
        .attr('aria-expanded', show)
        .attr('aria-controls', id);

    var buttonRow = $('<div class="row"></div>');
    var buttonCol = $('<div class="col-md-12"></div>');

    buttonCol.append(showCodeButton);
    buttonRow.append(buttonCol);

    div.before(buttonRow);

    // hack: return show to false, otherwise all next codeBlocks will be shown!
    show = false;

    // update state of button on show/hide
    div.on('hidden.bs.collapse', function () {
      showCodeText.text('Code');
    });
    div.on('show.bs.collapse', function () {
      showCodeText.text('Hide');
    });
  });

}
</script>
<script>
/* ========================================================================
 * Bootstrap: dropdown.js v3.3.7
 * http://getbootstrap.com/javascript/#dropdowns
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // DROPDOWN CLASS DEFINITION
  // =========================

  var backdrop = '.dropdown-backdrop'
  var toggle   = '[data-toggle="dropdown"]'
  var Dropdown = function (element) {
    $(element).on('click.bs.dropdown', this.toggle)
  }

  Dropdown.VERSION = '3.3.7'

  function getParent($this) {
    var selector = $this.attr('data-target')

    if (!selector) {
      selector = $this.attr('href')
      selector = selector && /#[A-Za-z]/.test(selector) && selector.replace(/.*(?=#[^\s]*$)/, '') // strip for ie7
    }

    var $parent = selector && $(selector)

    return $parent && $parent.length ? $parent : $this.parent()
  }

  function clearMenus(e) {
    if (e && e.which === 3) return
    $(backdrop).remove()
    $(toggle).each(function () {
      var $this         = $(this)
      var $parent       = getParent($this)
      var relatedTarget = { relatedTarget: this }

      if (!$parent.hasClass('open')) return

      if (e && e.type == 'click' && /input|textarea/i.test(e.target.tagName) && $.contains($parent[0], e.target)) return

      $parent.trigger(e = $.Event('hide.bs.dropdown', relatedTarget))

      if (e.isDefaultPrevented()) return

      $this.attr('aria-expanded', 'false')
      $parent.removeClass('open').trigger($.Event('hidden.bs.dropdown', relatedTarget))
    })
  }

  Dropdown.prototype.toggle = function (e) {
    var $this = $(this)

    if ($this.is('.disabled, :disabled')) return

    var $parent  = getParent($this)
    var isActive = $parent.hasClass('open')

    clearMenus()

    if (!isActive) {
      if ('ontouchstart' in document.documentElement && !$parent.closest('.navbar-nav').length) {
        // if mobile we use a backdrop because click events don't delegate
        $(document.createElement('div'))
          .addClass('dropdown-backdrop')
          .insertAfter($(this))
          .on('click', clearMenus)
      }

      var relatedTarget = { relatedTarget: this }
      $parent.trigger(e = $.Event('show.bs.dropdown', relatedTarget))

      if (e.isDefaultPrevented()) return

      $this
        .trigger('focus')
        .attr('aria-expanded', 'true')

      $parent
        .toggleClass('open')
        .trigger($.Event('shown.bs.dropdown', relatedTarget))
    }

    return false
  }

  Dropdown.prototype.keydown = function (e) {
    if (!/(38|40|27|32)/.test(e.which) || /input|textarea/i.test(e.target.tagName)) return

    var $this = $(this)

    e.preventDefault()
    e.stopPropagation()

    if ($this.is('.disabled, :disabled')) return

    var $parent  = getParent($this)
    var isActive = $parent.hasClass('open')

    if (!isActive && e.which != 27 || isActive && e.which == 27) {
      if (e.which == 27) $parent.find(toggle).trigger('focus')
      return $this.trigger('click')
    }

    var desc = ' li:not(.disabled):visible a'
    var $items = $parent.find('.dropdown-menu' + desc)

    if (!$items.length) return

    var index = $items.index(e.target)

    if (e.which == 38 && index > 0)                 index--         // up
    if (e.which == 40 && index < $items.length - 1) index++         // down
    if (!~index)                                    index = 0

    $items.eq(index).trigger('focus')
  }


  // DROPDOWN PLUGIN DEFINITION
  // ==========================

  function Plugin(option) {
    return this.each(function () {
      var $this = $(this)
      var data  = $this.data('bs.dropdown')

      if (!data) $this.data('bs.dropdown', (data = new Dropdown(this)))
      if (typeof option == 'string') data[option].call($this)
    })
  }

  var old = $.fn.dropdown

  $.fn.dropdown             = Plugin
  $.fn.dropdown.Constructor = Dropdown


  // DROPDOWN NO CONFLICT
  // ====================

  $.fn.dropdown.noConflict = function () {
    $.fn.dropdown = old
    return this
  }


  // APPLY TO STANDARD DROPDOWN ELEMENTS
  // ===================================

  $(document)
    .on('click.bs.dropdown.data-api', clearMenus)
    .on('click.bs.dropdown.data-api', '.dropdown form', function (e) { e.stopPropagation() })
    .on('click.bs.dropdown.data-api', toggle, Dropdown.prototype.toggle)
    .on('keydown.bs.dropdown.data-api', toggle, Dropdown.prototype.keydown)
    .on('keydown.bs.dropdown.data-api', '.dropdown-menu', Dropdown.prototype.keydown)

}(jQuery);
</script>
<style type="text/css">
.code-folding-btn {
  margin-bottom: 4px;
}

.row { display: flex; }
.collapse { display: none; }
.in { display:block }
.pull-right > .dropdown-menu {
    right: 0;
    left: auto;
}

.dropdown-menu {
    position: absolute;
    top: 100%;
    left: 0;
    z-index: 1000;
    display: none;
    float: left;
    min-width: 160px;
    padding: 5px 0;
    margin: 2px 0 0;
    font-size: 14px;
    text-align: left;
    list-style: none;
    background-color: #fff;
    -webkit-background-clip: padding-box;
    background-clip: padding-box;
    border: 1px solid #ccc;
    border: 1px solid rgba(0,0,0,.15);
    border-radius: 4px;
    -webkit-box-shadow: 0 6px 12px rgba(0,0,0,.175);
    box-shadow: 0 6px 12px rgba(0,0,0,.175);
}

.open > .dropdown-menu {
    display: block;
    color: #ffffff;
    background-color: #ffffff;
    background-image: none;
    border-color: #92897e;
}

.dropdown-menu > li > a {
  display: block;
  padding: 3px 20px;
  clear: both;
  font-weight: 400;
  line-height: 1.42857143;
  color: #000000;
  white-space: nowrap;
}

.dropdown-menu > li > a:hover,
.dropdown-menu > li > a:focus {
  color: #ffffff;
  text-decoration: none;
  background-color: #e95420;
}

.dropdown-menu > .active > a,
.dropdown-menu > .active > a:hover,
.dropdown-menu > .active > a:focus {
  color: #ffffff;
  text-decoration: none;
  background-color: #e95420;
  outline: 0;
}
.dropdown-menu > .disabled > a,
.dropdown-menu > .disabled > a:hover,
.dropdown-menu > .disabled > a:focus {
  color: #aea79f;
}

.dropdown-menu > .disabled > a:hover,
.dropdown-menu > .disabled > a:focus {
  text-decoration: none;
  cursor: not-allowed;
  background-color: transparent;
  background-image: none;
  filter: progid:DXImageTransform.Microsoft.gradient(enabled = false);
}

.btn {
  display: inline-block;
  margin-bottom: 1;
  font-weight: normal;
  text-align: center;
  white-space: nowrap;
  vertical-align: middle;
  -ms-touch-action: manipulation;
      touch-action: manipulation;
  cursor: pointer;
  background-image: none;
  border: 1px solid transparent;
  padding: 4px 8px;
  font-size: 14px;
  line-height: 1.42857143;
  border-radius: 4px;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.btn:focus,
.btn:active:focus,
.btn.active:focus,
.btn.focus,
.btn:active.focus,
.btn.active.focus {
  outline: 5px auto -webkit-focus-ring-color;
  outline-offset: -2px;
}
.btn:hover,
.btn:focus,
.btn.focus {
  color: #ffffff;
  text-decoration: none;
}
.btn:active,
.btn.active {
  background-image: none;
  outline: 0;
  box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
}
.btn.disabled,
.btn[disabled],
fieldset[disabled] .btn {
  cursor: not-allowed;
  filter: alpha(opacity=65);
  opacity: 0.65;
  box-shadow: none;
}
a.btn.disabled,
fieldset[disabled] a.btn {
  pointer-events: none;
}
.btn-default {
  color: #ffffff;
  background-color: #aea79f; #important
  border-color: #aea79f;
}

.btn-default:focus,
.btn-default.focus {
  color: #ffffff;
  background-color: #978e83;
  border-color: #6f675e;
}

.btn-default:hover {
  color: #ffffff;
  background-color: #978e83;
  border-color: #92897e;
}
.btn-default:active,
.btn-default.active,
.btn-group > .btn:not(:first-child):not(:last-child):not(.dropdown-toggle) {
  border-radius: 0;
}
.btn-group > .btn:first-child {
  margin-left: 0;
}
.btn-group > .btn:first-child:not(:last-child):not(.dropdown-toggle) {
  border-top-right-radius: 0;
  border-bottom-right-radius: 0;
}
.btn-group > .btn:last-child:not(:first-child),
.btn-group > .dropdown-toggle:not(:first-child) {
  border-top-left-radius: 0;
  border-bottom-left-radius: 0;
}
.btn-group > .btn-group {
  float: left;
}
.btn-group > .btn-group:not(:first-child):not(:last-child) > .btn {
  border-radius: 0;
}
.btn-group > .btn-group:first-child:not(:last-child) > .btn:last-child,
.btn-group > .btn-group:first-child:not(:last-child) > .dropdown-toggle {
  border-top-right-radius: 0;
  border-bottom-right-radius: 0;
}
.btn-group > .btn-group:last-child:not(:first-child) > .btn:first-child {
  border-top-left-radius: 0;
  border-bottom-left-radius: 0;
}
.btn-group .dropdown-toggle:active,
.btn-group.open .dropdown-toggle {
  outline: 0;
}
.btn-group > .btn + .dropdown-toggle {
  padding-right: 8px;
  padding-left: 8px;
}
.btn-group > .btn-lg + .dropdown-toggle {
  padding-right: 12px;
  padding-left: 12px;
}
.btn-group.open .dropdown-toggle {
  box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
}
.btn-group.open .dropdown-toggle.btn-link {
  box-shadow: none;
}

</style>
<script>
var str = '<div class="btn-group pull-right" style="position: fixed; right: 50px; top: 10px; z-index: 200"><button type="button" class="btn btn-default btn-xs dropdown-toggle" id="allCodeButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true" data-_extension-text-contrast=""><span>Code</span> <span class="caret"></span></button><ul class="dropdown-menu" style="min-width: 50px;"><li><a id="rmd-show-all-code" href="#">Show All Code</a></li><li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li></ul></div>';
document.write(str);
</script>
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "hide");
});
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="assets/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="https://www.ucl.ac.uk/module-catalogue/modules/geographic-information-systems-and-science-CASA0005"><img src="general_images/casa_logo.jpg"></a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgement"><i class="fa fa-check"></i>Acknowledgement</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#citation"><i class="fa fa-check"></i>Citation</a></li>
</ul></li>
<li class="part"><span><b>Course information</b></span></li>
<li class="chapter" data-level="" data-path="hello-gis.html"><a href="hello-gis.html"><i class="fa fa-check"></i>Hello GIS</a>
<ul>
<li class="chapter" data-level="" data-path="hello-gis.html"><a href="hello-gis.html#intended-course-learning-outcomes"><i class="fa fa-check"></i>Intended course learning outcomes</a></li>
<li class="chapter" data-level="" data-path="hello-gis.html"><a href="hello-gis.html#how-to-use-this-book"><i class="fa fa-check"></i>How to use this book</a></li>
<li class="chapter" data-level="" data-path="hello-gis.html"><a href="hello-gis.html#getting-started"><i class="fa fa-check"></i>Getting started</a></li>
<li class="chapter" data-level="" data-path="hello-gis.html"><a href="hello-gis.html#how-to-download-data-and-files-from-github"><i class="fa fa-check"></i>How to download data and files from GitHub</a>
<ul>
<li class="chapter" data-level="" data-path="hello-gis.html"><a href="hello-gis.html#option-1"><i class="fa fa-check"></i>Option 1</a></li>
<li class="chapter" data-level="" data-path="hello-gis.html"><a href="hello-gis.html#option-2"><i class="fa fa-check"></i>Option 2</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hello-gis.html"><a href="hello-gis.html#self-guided-learning"><i class="fa fa-check"></i>Self guided learning</a></li>
<li class="chapter" data-level="" data-path="hello-gis.html"><a href="hello-gis.html#interactive-lectures"><i class="fa fa-check"></i>Interactive lectures</a></li>
<li class="chapter" data-level="" data-path="hello-gis.html"><a href="hello-gis.html#more-help"><i class="fa fa-check"></i>More help</a></li>
<li class="chapter" data-level="" data-path="hello-gis.html"><a href="hello-gis.html#reading-list"><i class="fa fa-check"></i>Reading list</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="software-installation.html"><a href="software-installation.html"><i class="fa fa-check"></i>Software installation</a>
<ul>
<li class="chapter" data-level="" data-path="software-installation.html"><a href="software-installation.html#qgis"><i class="fa fa-check"></i>QGIS</a></li>
<li class="chapter" data-level="" data-path="software-installation.html"><a href="software-installation.html#r"><i class="fa fa-check"></i>R</a>
<ul>
<li class="chapter" data-level="" data-path="software-installation.html"><a href="software-installation.html#setup-1"><i class="fa fa-check"></i>Setup 1</a></li>
<li class="chapter" data-level="" data-path="software-installation.html"><a href="software-installation.html#setup-2"><i class="fa fa-check"></i>Setup 2</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="software-installation.html"><a href="software-installation.html#arcgis"><i class="fa fa-check"></i>ArcGIS</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="external-usage.html"><a href="external-usage.html"><i class="fa fa-check"></i>External usage</a>
<ul>
<li class="chapter" data-level="" data-path="external-usage.html"><a href="external-usage.html#how-to-adopt-this-course"><i class="fa fa-check"></i>How to adopt this course</a></li>
<li class="chapter" data-level="" data-path="external-usage.html"><a href="external-usage.html#how-to-contribute"><i class="fa fa-check"></i>How to contribute</a></li>
<li class="chapter" data-level="" data-path="external-usage.html"><a href="external-usage.html#supporting-the-module"><i class="fa fa-check"></i>Supporting the module</a></li>
<li class="chapter" data-level="" data-path="external-usage.html"><a href="external-usage.html#license"><i class="fa fa-check"></i>License</a></li>
<li class="chapter" data-level="" data-path="external-usage.html"><a href="external-usage.html#updates"><i class="fa fa-check"></i>Updates</a></li>
<li class="chapter" data-level="" data-path="external-usage.html"><a href="external-usage.html#packages-1"><i class="fa fa-check"></i>Packages</a></li>
</ul></li>
<li class="part"><span><b>I GIS tools</b></span></li>
<li class="chapter" data-level="1" data-path="geographic-information.html"><a href="geographic-information.html"><i class="fa fa-check"></i><b>1</b> Geographic Information</a>
<ul>
<li class="chapter" data-level="1.1" data-path="geographic-information.html"><a href="geographic-information.html#learning-outcomes"><i class="fa fa-check"></i><b>1.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="1.2" data-path="geographic-information.html"><a href="geographic-information.html#homework"><i class="fa fa-check"></i><b>1.2</b> Homework</a></li>
<li class="chapter" data-level="1.3" data-path="geographic-information.html"><a href="geographic-information.html#recommended-listening"><i class="fa fa-check"></i><b>1.3</b> Recommended listening 🎧</a></li>
<li class="chapter" data-level="1.4" data-path="geographic-information.html"><a href="geographic-information.html#the-basics-of-geographic-information"><i class="fa fa-check"></i><b>1.4</b> The Basics of Geographic Information</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="geographic-information.html"><a href="geographic-information.html#data-types-in-statistics"><i class="fa fa-check"></i><b>1.4.1</b> Data types in statistics</a></li>
<li class="chapter" data-level="1.4.2" data-path="geographic-information.html"><a href="geographic-information.html#important-gis-data-formats"><i class="fa fa-check"></i><b>1.4.2</b> Important GIS data formats</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="geographic-information.html"><a href="geographic-information.html#general-data-flow"><i class="fa fa-check"></i><b>1.5</b> General data flow</a></li>
<li class="chapter" data-level="1.6" data-path="geographic-information.html"><a href="geographic-information.html#data"><i class="fa fa-check"></i><b>1.6</b> Data</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="geographic-information.html"><a href="geographic-information.html#file-paths"><i class="fa fa-check"></i><b>1.6.1</b> File paths</a></li>
<li class="chapter" data-level="1.6.2" data-path="geographic-information.html"><a href="geographic-information.html#data-download"><i class="fa fa-check"></i><b>1.6.2</b> Data download</a></li>
<li class="chapter" data-level="1.6.3" data-path="geographic-information.html"><a href="geographic-information.html#data-pre-processing"><i class="fa fa-check"></i><b>1.6.3</b> Data pre-processing</a></li>
<li class="chapter" data-level="1.6.4" data-path="geographic-information.html"><a href="geographic-information.html#qgis-1"><i class="fa fa-check"></i><b>1.6.4</b> QGIS</a></li>
<li class="chapter" data-level="1.6.5" data-path="geographic-information.html"><a href="geographic-information.html#r-1"><i class="fa fa-check"></i><b>1.6.5</b> R</a></li>
<li class="chapter" data-level="1.6.6" data-path="geographic-information.html"><a href="geographic-information.html#export-data-1"><i class="fa fa-check"></i><b>1.6.6</b> Export data</a></li>
<li class="chapter" data-level="1.6.7" data-path="geographic-information.html"><a href="geographic-information.html#what-will-i-use-1"><i class="fa fa-check"></i><b>1.6.7</b> What will I use</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="geographic-information.html"><a href="geographic-information.html#data-sources-and-task"><i class="fa fa-check"></i><b>1.7</b> Data sources and task</a>
<ul>
<li class="chapter" data-level="1.7.1" data-path="geographic-information.html"><a href="geographic-information.html#uk-data-service"><i class="fa fa-check"></i><b>1.7.1</b> UK Data Service</a></li>
<li class="chapter" data-level="1.7.2" data-path="geographic-information.html"><a href="geographic-information.html#ons"><i class="fa fa-check"></i><b>1.7.2</b> ONS</a></li>
<li class="chapter" data-level="1.7.3" data-path="geographic-information.html"><a href="geographic-information.html#nomis"><i class="fa fa-check"></i><b>1.7.3</b> nomis</a></li>
<li class="chapter" data-level="1.7.4" data-path="geographic-information.html"><a href="geographic-information.html#os"><i class="fa fa-check"></i><b>1.7.4</b> OS</a></li>
<li class="chapter" data-level="1.7.5" data-path="geographic-information.html"><a href="geographic-information.html#edina-digimap"><i class="fa fa-check"></i><b>1.7.5</b> Edina Digimap</a></li>
<li class="chapter" data-level="1.7.6" data-path="geographic-information.html"><a href="geographic-information.html#osm"><i class="fa fa-check"></i><b>1.7.6</b> OSM</a></li>
<li class="chapter" data-level="1.7.7" data-path="geographic-information.html"><a href="geographic-information.html#defra"><i class="fa fa-check"></i><b>1.7.7</b> DEFRA</a></li>
<li class="chapter" data-level="1.7.8" data-path="geographic-information.html"><a href="geographic-information.html#data-lists"><i class="fa fa-check"></i><b>1.7.8</b> Data lists</a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="geographic-information.html"><a href="geographic-information.html#summary"><i class="fa fa-check"></i><b>1.8</b> Summary</a></li>
<li class="chapter" data-level="1.9" data-path="geographic-information.html"><a href="geographic-information.html#feedback"><i class="fa fa-check"></i><b>1.9</b> Feedback</a></li>
<li class="chapter" data-level="1.10" data-path="geographic-information.html"><a href="geographic-information.html#mac-r-issues"><i class="fa fa-check"></i><b>1.10</b> Mac R issues</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introduction-to-r.html"><a href="introduction-to-r.html"><i class="fa fa-check"></i><b>2</b> Introduction to R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#learning-outcomes-1"><i class="fa fa-check"></i><b>2.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="2.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#homework-1"><i class="fa fa-check"></i><b>2.2</b> Homework</a></li>
<li class="chapter" data-level="2.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#recommended-listening-1"><i class="fa fa-check"></i><b>2.3</b> Recommended listening 🎧</a></li>
<li class="chapter" data-level="2.4" data-path="introduction-to-r.html"><a href="introduction-to-r.html#introduction-1"><i class="fa fa-check"></i><b>2.4</b> Introduction</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#online-forums-are-your-friend"><i class="fa fa-check"></i><b>2.4.1</b> Online forums are your friend!!</a></li>
<li class="chapter" data-level="2.4.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#health-warning"><i class="fa fa-check"></i><b>2.4.2</b> Health warning</a></li>
<li class="chapter" data-level="2.4.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#r-and-rstudio"><i class="fa fa-check"></i><b>2.4.3</b> R and RStudio</a></li>
<li class="chapter" data-level="2.4.4" data-path="introduction-to-r.html"><a href="introduction-to-r.html#getting-started-1"><i class="fa fa-check"></i><b>2.4.4</b> Getting started</a></li>
<li class="chapter" data-level="2.4.5" data-path="introduction-to-r.html"><a href="introduction-to-r.html#basics-2"><i class="fa fa-check"></i><b>2.4.5</b> Basics</a></li>
<li class="chapter" data-level="2.4.6" data-path="introduction-to-r.html"><a href="introduction-to-r.html#scripts-and-some-basic-commands"><i class="fa fa-check"></i><b>2.4.6</b> Scripts and some basic commands</a></li>
<li class="chapter" data-level="2.4.7" data-path="introduction-to-r.html"><a href="introduction-to-r.html#functions"><i class="fa fa-check"></i><b>2.4.7</b> Functions</a></li>
<li class="chapter" data-level="2.4.8" data-path="introduction-to-r.html"><a href="introduction-to-r.html#basic-plotting"><i class="fa fa-check"></i><b>2.4.8</b> Basic plotting</a></li>
<li class="chapter" data-level="2.4.9" data-path="introduction-to-r.html"><a href="introduction-to-r.html#help"><i class="fa fa-check"></i><b>2.4.9</b> Help</a></li>
<li class="chapter" data-level="2.4.10" data-path="introduction-to-r.html"><a href="introduction-to-r.html#data-structures"><i class="fa fa-check"></i><b>2.4.10</b> Data structures</a></li>
<li class="chapter" data-level="2.4.11" data-path="introduction-to-r.html"><a href="introduction-to-r.html#elements-of-a-data-frame"><i class="fa fa-check"></i><b>2.4.11</b> Elements of a data frame</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="introduction-to-r.html"><a href="introduction-to-r.html#reading-data-into-r"><i class="fa fa-check"></i><b>2.5</b> Reading data into R</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#old-skool-cleaning"><i class="fa fa-check"></i><b>2.5.1</b> Old skool cleaning</a></li>
<li class="chapter" data-level="2.5.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#here"><i class="fa fa-check"></i><b>2.5.2</b> Here</a></li>
<li class="chapter" data-level="2.5.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#new-skool-cleaning"><i class="fa fa-check"></i><b>2.5.3</b> New skool cleaning</a></li>
<li class="chapter" data-level="2.5.4" data-path="introduction-to-r.html"><a href="introduction-to-r.html#examining-your-new-data"><i class="fa fa-check"></i><b>2.5.4</b> Examining your new data</a></li>
<li class="chapter" data-level="2.5.5" data-path="introduction-to-r.html"><a href="introduction-to-r.html#data-manipulation-in-r"><i class="fa fa-check"></i><b>2.5.5</b> Data manipulation in R</a></li>
<li class="chapter" data-level="2.5.6" data-path="introduction-to-r.html"><a href="introduction-to-r.html#plotting"><i class="fa fa-check"></i><b>2.5.6</b> Plotting</a></li>
<li class="chapter" data-level="2.5.7" data-path="introduction-to-r.html"><a href="introduction-to-r.html#pimp-my-graph"><i class="fa fa-check"></i><b>2.5.7</b> Pimp my graph!</a></li>
<li class="chapter" data-level="2.5.8" data-path="introduction-to-r.html"><a href="introduction-to-r.html#spatial-data-in-r"><i class="fa fa-check"></i><b>2.5.8</b> Spatial Data in R</a></li>
<li class="chapter" data-level="2.5.9" data-path="introduction-to-r.html"><a href="introduction-to-r.html#simple-mapping"><i class="fa fa-check"></i><b>2.5.9</b> Simple mapping</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="introduction-to-r.html"><a href="introduction-to-r.html#tidying-data"><i class="fa fa-check"></i><b>2.6</b> Tidying data</a></li>
<li class="chapter" data-level="2.7" data-path="introduction-to-r.html"><a href="introduction-to-r.html#feedback-1"><i class="fa fa-check"></i><b>2.7</b> Feedback</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="spatial-descriptive-statistics.html"><a href="spatial-descriptive-statistics.html"><i class="fa fa-check"></i><b>3</b> Spatial descriptive statistics</a>
<ul>
<li class="chapter" data-level="3.1" data-path="spatial-descriptive-statistics.html"><a href="spatial-descriptive-statistics.html#learning-outcomes-2"><i class="fa fa-check"></i><b>3.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="3.2" data-path="spatial-descriptive-statistics.html"><a href="spatial-descriptive-statistics.html#homework-2"><i class="fa fa-check"></i><b>3.2</b> Homework</a></li>
<li class="chapter" data-level="3.3" data-path="spatial-descriptive-statistics.html"><a href="spatial-descriptive-statistics.html#recommended-listening-2"><i class="fa fa-check"></i><b>3.3</b> Recommended listening 🎧</a></li>
<li class="chapter" data-level="3.4" data-path="spatial-descriptive-statistics.html"><a href="spatial-descriptive-statistics.html#introduction-2"><i class="fa fa-check"></i><b>3.4</b> Introduction</a></li>
<li class="chapter" data-level="3.5" data-path="spatial-descriptive-statistics.html"><a href="spatial-descriptive-statistics.html#part-1-projections"><i class="fa fa-check"></i><b>3.5</b> Part 1 projections</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="spatial-descriptive-statistics.html"><a href="spatial-descriptive-statistics.html#changing-projections"><i class="fa fa-check"></i><b>3.5.1</b> Changing projections</a></li>
<li class="chapter" data-level="3.5.2" data-path="spatial-descriptive-statistics.html"><a href="spatial-descriptive-statistics.html#worldclim-data"><i class="fa fa-check"></i><b>3.5.2</b> WorldClim data</a></li>
<li class="chapter" data-level="3.5.3" data-path="spatial-descriptive-statistics.html"><a href="spatial-descriptive-statistics.html#data-loading"><i class="fa fa-check"></i><b>3.5.3</b> Data loading</a></li>
<li class="chapter" data-level="3.5.4" data-path="spatial-descriptive-statistics.html"><a href="spatial-descriptive-statistics.html#raster-location"><i class="fa fa-check"></i><b>3.5.4</b> Raster location</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="spatial-descriptive-statistics.html"><a href="spatial-descriptive-statistics.html#part-2-descriptive-statistics"><i class="fa fa-check"></i><b>3.6</b> Part 2 descriptive statistics</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="spatial-descriptive-statistics.html"><a href="spatial-descriptive-statistics.html#data-preparation"><i class="fa fa-check"></i><b>3.6.1</b> Data preparation</a></li>
<li class="chapter" data-level="3.6.2" data-path="spatial-descriptive-statistics.html"><a href="spatial-descriptive-statistics.html#histogram"><i class="fa fa-check"></i><b>3.6.2</b> Histogram</a></li>
<li class="chapter" data-level="3.6.3" data-path="spatial-descriptive-statistics.html"><a href="spatial-descriptive-statistics.html#using-more-data"><i class="fa fa-check"></i><b>3.6.3</b> Using more data</a></li>
<li class="chapter" data-level="3.6.4" data-path="spatial-descriptive-statistics.html"><a href="spatial-descriptive-statistics.html#histogram-with-ggplot"><i class="fa fa-check"></i><b>3.6.4</b> Histogram with ggplot</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="spatial-descriptive-statistics.html"><a href="spatial-descriptive-statistics.html#feedback-2"><i class="fa fa-check"></i><b>3.7</b> Feedback</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html"><i class="fa fa-check"></i><b>4</b> Git, GitHub and RMarkdown</a>
<ul>
<li class="chapter" data-level="4.1" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#learning-outcomes-3"><i class="fa fa-check"></i><b>4.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="4.2" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#homework-3"><i class="fa fa-check"></i><b>4.2</b> Homework</a></li>
<li class="chapter" data-level="4.3" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#recommended-listening-3"><i class="fa fa-check"></i><b>4.3</b> Recommended listening 🎧</a></li>
<li class="chapter" data-level="4.4" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#introduction-3"><i class="fa fa-check"></i><b>4.4</b> Introduction</a></li>
<li class="chapter" data-level="4.5" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#git-and-github"><i class="fa fa-check"></i><b>4.5</b> Git and GitHub</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#the-three-ways"><i class="fa fa-check"></i><b>4.5.1</b> The three ways</a></li>
<li class="chapter" data-level="4.5.2" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#set-up-your-github"><i class="fa fa-check"></i><b>4.5.2</b> Set up your GitHub</a></li>
<li class="chapter" data-level="4.5.3" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#using-rstudio-with-git"><i class="fa fa-check"></i><b>4.5.3</b> Using RStudio with Git</a></li>
<li class="chapter" data-level="4.5.4" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#using-the-git-gui---way-1"><i class="fa fa-check"></i><b>4.5.4</b> Using the Git GUI - way 1</a></li>
<li class="chapter" data-level="4.5.5" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#create-a-new-version-control-in-rstudio---way-2"><i class="fa fa-check"></i><b>4.5.5</b> Create a new version control in RStudio - way 2</a></li>
<li class="chapter" data-level="4.5.6" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#if-have-have-an-existing-project---way-3"><i class="fa fa-check"></i><b>4.5.6</b> If have have an existing project - way 3</a></li>
<li class="chapter" data-level="4.5.7" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#commiting-to-git"><i class="fa fa-check"></i><b>4.5.7</b> Commiting to Git</a></li>
<li class="chapter" data-level="4.5.8" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#push-to-github"><i class="fa fa-check"></i><b>4.5.8</b> Push to Github</a></li>
<li class="chapter" data-level="4.5.9" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#pull-from-github"><i class="fa fa-check"></i><b>4.5.9</b> Pull from GitHub</a></li>
<li class="chapter" data-level="4.5.10" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#using-git-outside-rstudio"><i class="fa fa-check"></i><b>4.5.10</b> Using Git outside RStudio</a></li>
<li class="chapter" data-level="4.5.11" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#troubleshooting"><i class="fa fa-check"></i><b>4.5.11</b> Troubleshooting</a></li>
<li class="chapter" data-level="4.5.12" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#fork-a-repository"><i class="fa fa-check"></i><b>4.5.12</b> Fork a repository</a></li>
<li class="chapter" data-level="4.5.13" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#branches"><i class="fa fa-check"></i><b>4.5.13</b> Branches</a></li>
<li class="chapter" data-level="4.5.14" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#back-in-time"><i class="fa fa-check"></i><b>4.5.14</b> Back in time</a></li>
<li class="chapter" data-level="4.5.15" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#health-warning-1"><i class="fa fa-check"></i><b>4.5.15</b> Health warning</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#rmarkdown"><i class="fa fa-check"></i><b>4.6</b> RMarkdown</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#html"><i class="fa fa-check"></i><b>4.6.1</b> HTML</a></li>
<li class="chapter" data-level="4.6.2" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#knit-options"><i class="fa fa-check"></i><b>4.6.2</b> Knit options</a></li>
<li class="chapter" data-level="4.6.3" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#shortcuts"><i class="fa fa-check"></i><b>4.6.3</b> Shortcuts</a></li>
<li class="chapter" data-level="4.6.4" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#renv"><i class="fa fa-check"></i><b>4.6.4</b> renv</a></li>
<li class="chapter" data-level="4.6.5" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#referencing-and-more"><i class="fa fa-check"></i><b>4.6.5</b> Referencing and more</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#further-reading"><i class="fa fa-check"></i><b>4.7</b> Further reading</a></li>
<li class="chapter" data-level="4.8" data-path="git-github-and-rmarkdown.html"><a href="git-github-and-rmarkdown.html#feedback-3"><i class="fa fa-check"></i><b>4.8</b> Feedback</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="map-making.html"><a href="map-making.html"><i class="fa fa-check"></i><b>5</b> Map making</a>
<ul>
<li class="chapter" data-level="5.1" data-path="map-making.html"><a href="map-making.html#learning-outcomes-4"><i class="fa fa-check"></i><b>5.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="5.2" data-path="map-making.html"><a href="map-making.html#homework-4"><i class="fa fa-check"></i><b>5.2</b> Homework</a></li>
<li class="chapter" data-level="5.3" data-path="map-making.html"><a href="map-making.html#recommended-listening-4"><i class="fa fa-check"></i><b>5.3</b> Recommended listening 🎧</a></li>
<li class="chapter" data-level="5.4" data-path="map-making.html"><a href="map-making.html#introduction-4"><i class="fa fa-check"></i><b>5.4</b> Introduction</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="map-making.html"><a href="map-making.html#osm-1"><i class="fa fa-check"></i><b>5.4.1</b> OSM</a></li>
<li class="chapter" data-level="5.4.2" data-path="map-making.html"><a href="map-making.html#airbnb"><i class="fa fa-check"></i><b>5.4.2</b> Airbnb</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="map-making.html"><a href="map-making.html#data-1"><i class="fa fa-check"></i><b>5.5</b> Data</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="map-making.html"><a href="map-making.html#osm-2"><i class="fa fa-check"></i><b>5.5.1</b> OSM</a></li>
<li class="chapter" data-level="5.5.2" data-path="map-making.html"><a href="map-making.html#london-boroughs"><i class="fa fa-check"></i><b>5.5.2</b> London boroughs</a></li>
<li class="chapter" data-level="5.5.3" data-path="map-making.html"><a href="map-making.html#world-cities"><i class="fa fa-check"></i><b>5.5.3</b> World cities</a></li>
<li class="chapter" data-level="5.5.4" data-path="map-making.html"><a href="map-making.html#airbnb-1"><i class="fa fa-check"></i><b>5.5.4</b> Airbnb</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="map-making.html"><a href="map-making.html#qgis-2"><i class="fa fa-check"></i><b>5.6</b> QGIS</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="map-making.html"><a href="map-making.html#load-data-2"><i class="fa fa-check"></i><b>5.6.1</b> Load data</a></li>
<li class="chapter" data-level="5.6.2" data-path="map-making.html"><a href="map-making.html#manipulate-data"><i class="fa fa-check"></i><b>5.6.2</b> Manipulate data</a></li>
<li class="chapter" data-level="5.6.3" data-path="map-making.html"><a href="map-making.html#map-data"><i class="fa fa-check"></i><b>5.6.3</b> Map data</a></li>
<li class="chapter" data-level="5.6.4" data-path="map-making.html"><a href="map-making.html#export-map"><i class="fa fa-check"></i><b>5.6.4</b> Export map</a></li>
<li class="chapter" data-level="5.6.5" data-path="map-making.html"><a href="map-making.html#graphical-modeler"><i class="fa fa-check"></i><b>5.6.5</b> Graphical modeler</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="map-making.html"><a href="map-making.html#r-2"><i class="fa fa-check"></i><b>5.7</b> R</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="map-making.html"><a href="map-making.html#static-map"><i class="fa fa-check"></i><b>5.7.1</b> Static map</a></li>
<li class="chapter" data-level="5.7.2" data-path="map-making.html"><a href="map-making.html#inset-map"><i class="fa fa-check"></i><b>5.7.2</b> Inset map</a></li>
<li class="chapter" data-level="5.7.3" data-path="map-making.html"><a href="map-making.html#export"><i class="fa fa-check"></i><b>5.7.3</b> Export</a></li>
<li class="chapter" data-level="5.7.4" data-path="map-making.html"><a href="map-making.html#basic-interactive-map"><i class="fa fa-check"></i><b>5.7.4</b> Basic interactive map</a></li>
<li class="chapter" data-level="5.7.5" data-path="map-making.html"><a href="map-making.html#advanced-interactive-map"><i class="fa fa-check"></i><b>5.7.5</b> Advanced interactive map</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="map-making.html"><a href="map-making.html#bad-maps"><i class="fa fa-check"></i><b>5.8</b> Bad maps</a></li>
<li class="chapter" data-level="5.9" data-path="map-making.html"><a href="map-making.html#feedback-4"><i class="fa fa-check"></i><b>5.9</b> Feedback</a></li>
</ul></li>
<li class="part"><span><b>II GIS analysis</b></span></li>
<li class="chapter" data-level="6" data-path="detecting-spatial-patterns.html"><a href="detecting-spatial-patterns.html"><i class="fa fa-check"></i><b>6</b> Detecting spatial patterns</a>
<ul>
<li class="chapter" data-level="6.1" data-path="detecting-spatial-patterns.html"><a href="detecting-spatial-patterns.html#learning-outcomes-5"><i class="fa fa-check"></i><b>6.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="6.2" data-path="detecting-spatial-patterns.html"><a href="detecting-spatial-patterns.html#homework-5"><i class="fa fa-check"></i><b>6.2</b> Homework</a></li>
<li class="chapter" data-level="6.3" data-path="detecting-spatial-patterns.html"><a href="detecting-spatial-patterns.html#recommended-listening-5"><i class="fa fa-check"></i><b>6.3</b> Recommended listening 🎧</a></li>
<li class="chapter" data-level="6.4" data-path="detecting-spatial-patterns.html"><a href="detecting-spatial-patterns.html#introduction-5"><i class="fa fa-check"></i><b>6.4</b> Introduction</a></li>
<li class="chapter" data-level="6.5" data-path="detecting-spatial-patterns.html"><a href="detecting-spatial-patterns.html#setting-up-your-data"><i class="fa fa-check"></i><b>6.5</b> Setting up your data</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="detecting-spatial-patterns.html"><a href="detecting-spatial-patterns.html#data-cleaning"><i class="fa fa-check"></i><b>6.5.1</b> Data cleaning</a></li>
<li class="chapter" data-level="6.5.2" data-path="detecting-spatial-patterns.html"><a href="detecting-spatial-patterns.html#spatial-subsetting"><i class="fa fa-check"></i><b>6.5.2</b> Spatial subsetting</a></li>
<li class="chapter" data-level="6.5.3" data-path="detecting-spatial-patterns.html"><a href="detecting-spatial-patterns.html#study-area"><i class="fa fa-check"></i><b>6.5.3</b> Study area</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="detecting-spatial-patterns.html"><a href="detecting-spatial-patterns.html#point-pattern-analysis"><i class="fa fa-check"></i><b>6.6</b> Point pattern analysis</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="detecting-spatial-patterns.html"><a href="detecting-spatial-patterns.html#kernel-density-estimation"><i class="fa fa-check"></i><b>6.6.1</b> Kernel Density Estimation</a></li>
<li class="chapter" data-level="6.6.2" data-path="detecting-spatial-patterns.html"><a href="detecting-spatial-patterns.html#quadrat-analysis"><i class="fa fa-check"></i><b>6.6.2</b> Quadrat Analysis</a></li>
<li class="chapter" data-level="6.6.3" data-path="detecting-spatial-patterns.html"><a href="detecting-spatial-patterns.html#try-experimenting"><i class="fa fa-check"></i><b>6.6.3</b> Try experimenting…</a></li>
<li class="chapter" data-level="6.6.4" data-path="detecting-spatial-patterns.html"><a href="detecting-spatial-patterns.html#ripleys-k"><i class="fa fa-check"></i><b>6.6.4</b> Ripley’s K</a></li>
<li class="chapter" data-level="6.6.5" data-path="detecting-spatial-patterns.html"><a href="detecting-spatial-patterns.html#alternatives-to-ripleys-k"><i class="fa fa-check"></i><b>6.6.5</b> Alternatives to Ripley’s K</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="detecting-spatial-patterns.html"><a href="detecting-spatial-patterns.html#density-based-spatial-clustering-of-applications-with-noise-dbscan"><i class="fa fa-check"></i><b>6.7</b> Density-based spatial clustering of applications with noise: DBSCAN</a></li>
<li class="chapter" data-level="6.8" data-path="detecting-spatial-patterns.html"><a href="detecting-spatial-patterns.html#point-pattern-analysis-summary"><i class="fa fa-check"></i><b>6.8</b> Point pattern analysis summary</a></li>
<li class="chapter" data-level="6.9" data-path="detecting-spatial-patterns.html"><a href="detecting-spatial-patterns.html#analysing-spatial-autocorrelation-with-morans-i-lisa-and-friends"><i class="fa fa-check"></i><b>6.9</b> Analysing Spatial Autocorrelation with Moran’s I, LISA and friends</a>
<ul>
<li class="chapter" data-level="6.9.1" data-path="detecting-spatial-patterns.html"><a href="detecting-spatial-patterns.html#data-download-1"><i class="fa fa-check"></i><b>6.9.1</b> Data download</a></li>
<li class="chapter" data-level="6.9.2" data-path="detecting-spatial-patterns.html"><a href="detecting-spatial-patterns.html#data-cleaning-1"><i class="fa fa-check"></i><b>6.9.2</b> Data cleaning</a></li>
<li class="chapter" data-level="6.9.3" data-path="detecting-spatial-patterns.html"><a href="detecting-spatial-patterns.html#data-manipulation"><i class="fa fa-check"></i><b>6.9.3</b> Data manipulation</a></li>
<li class="chapter" data-level="6.9.4" data-path="detecting-spatial-patterns.html"><a href="detecting-spatial-patterns.html#spatial-autocorrelation"><i class="fa fa-check"></i><b>6.9.4</b> Spatial autocorrelation</a></li>
<li class="chapter" data-level="6.9.5" data-path="detecting-spatial-patterns.html"><a href="detecting-spatial-patterns.html#mapping-outputs"><i class="fa fa-check"></i><b>6.9.5</b> Mapping outputs</a></li>
<li class="chapter" data-level="6.9.6" data-path="detecting-spatial-patterns.html"><a href="detecting-spatial-patterns.html#other-variables"><i class="fa fa-check"></i><b>6.9.6</b> Other variables</a></li>
</ul></li>
<li class="chapter" data-level="6.10" data-path="detecting-spatial-patterns.html"><a href="detecting-spatial-patterns.html#feedback-5"><i class="fa fa-check"></i><b>6.10</b> Feedback</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="explaining-spatial-patterns.html"><a href="explaining-spatial-patterns.html"><i class="fa fa-check"></i><b>7</b> Explaining spatial patterns</a>
<ul>
<li class="chapter" data-level="7.1" data-path="explaining-spatial-patterns.html"><a href="explaining-spatial-patterns.html#learning-objectives"><i class="fa fa-check"></i><b>7.1</b> Learning objectives</a></li>
<li class="chapter" data-level="7.2" data-path="explaining-spatial-patterns.html"><a href="explaining-spatial-patterns.html#homework-6"><i class="fa fa-check"></i><b>7.2</b> Homework</a></li>
<li class="chapter" data-level="7.3" data-path="explaining-spatial-patterns.html"><a href="explaining-spatial-patterns.html#recommended-listening-6"><i class="fa fa-check"></i><b>7.3</b> Recommended listening 🎧</a></li>
<li class="chapter" data-level="7.4" data-path="explaining-spatial-patterns.html"><a href="explaining-spatial-patterns.html#introduction-6"><i class="fa fa-check"></i><b>7.4</b> Introduction</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="explaining-spatial-patterns.html"><a href="explaining-spatial-patterns.html#setting-up-your-data-1"><i class="fa fa-check"></i><b>7.4.1</b> Setting up your Data</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="explaining-spatial-patterns.html"><a href="explaining-spatial-patterns.html#analysing-gcse-exam-performance---testing-a-research-hypothesis"><i class="fa fa-check"></i><b>7.5</b> Analysing GCSE exam performance - testing a research hypothesis</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="explaining-spatial-patterns.html"><a href="explaining-spatial-patterns.html#research-question-and-hypothesis"><i class="fa fa-check"></i><b>7.5.1</b> Research Question and Hypothesis</a></li>
<li class="chapter" data-level="7.5.2" data-path="explaining-spatial-patterns.html"><a href="explaining-spatial-patterns.html#regression-basics"><i class="fa fa-check"></i><b>7.5.2</b> Regression Basics</a></li>
<li class="chapter" data-level="7.5.3" data-path="explaining-spatial-patterns.html"><a href="explaining-spatial-patterns.html#running-a-regression-model-in-r"><i class="fa fa-check"></i><b>7.5.3</b> Running a Regression Model in R</a></li>
<li class="chapter" data-level="7.5.4" data-path="explaining-spatial-patterns.html"><a href="explaining-spatial-patterns.html#bootstrap-resampling"><i class="fa fa-check"></i><b>7.5.4</b> Bootstrap resampling</a></li>
<li class="chapter" data-level="7.5.5" data-path="explaining-spatial-patterns.html"><a href="explaining-spatial-patterns.html#assumptions-underpinning-linear-regression"><i class="fa fa-check"></i><b>7.5.5</b> Assumptions Underpinning Linear Regression</a></li>
<li class="chapter" data-level="7.5.6" data-path="explaining-spatial-patterns.html"><a href="explaining-spatial-patterns.html#assumption-1---there-is-a-linear-relationship-between-the-dependent-and-independent-variables"><i class="fa fa-check"></i><b>7.5.6</b> Assumption 1 - There is a linear relationship between the dependent and independent variables</a></li>
<li class="chapter" data-level="7.5.7" data-path="explaining-spatial-patterns.html"><a href="explaining-spatial-patterns.html#assumption-2---the-residuals-in-your-model-should-be-normally-distributed"><i class="fa fa-check"></i><b>7.5.7</b> Assumption 2 - The residuals in your model should be normally distributed</a></li>
<li class="chapter" data-level="7.5.8" data-path="explaining-spatial-patterns.html"><a href="explaining-spatial-patterns.html#assumption-3---no-multicolinearity-in-the-independent-variables"><i class="fa fa-check"></i><b>7.5.8</b> Assumption 3 - No Multicolinearity in the independent variables</a></li>
<li class="chapter" data-level="7.5.9" data-path="explaining-spatial-patterns.html"><a href="explaining-spatial-patterns.html#assumption-4---homoscedasticity"><i class="fa fa-check"></i><b>7.5.9</b> Assumption 4 - Homoscedasticity</a></li>
<li class="chapter" data-level="7.5.10" data-path="explaining-spatial-patterns.html"><a href="explaining-spatial-patterns.html#assumption-5---independence-of-errors"><i class="fa fa-check"></i><b>7.5.10</b> Assumption 5 - Independence of Errors</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="explaining-spatial-patterns.html"><a href="explaining-spatial-patterns.html#spatial-regression-models"><i class="fa fa-check"></i><b>7.6</b> Spatial Regression Models</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="explaining-spatial-patterns.html"><a href="explaining-spatial-patterns.html#dealing-with-spatially-autocorrelated-residuals---spatial-lag-and-spatial-error-models"><i class="fa fa-check"></i><b>7.6.1</b> Dealing with Spatially Autocorrelated Residuals - Spatial Lag and Spatial Error models</a></li>
<li class="chapter" data-level="7.6.2" data-path="explaining-spatial-patterns.html"><a href="explaining-spatial-patterns.html#key-advice"><i class="fa fa-check"></i><b>7.6.2</b> Key advice</a></li>
<li class="chapter" data-level="7.6.3" data-path="explaining-spatial-patterns.html"><a href="explaining-spatial-patterns.html#which-model-to-use"><i class="fa fa-check"></i><b>7.6.3</b> Which model to use</a></li>
<li class="chapter" data-level="7.6.4" data-path="explaining-spatial-patterns.html"><a href="explaining-spatial-patterns.html#more-data"><i class="fa fa-check"></i><b>7.6.4</b> More data</a></li>
<li class="chapter" data-level="7.6.5" data-path="explaining-spatial-patterns.html"><a href="explaining-spatial-patterns.html#extending-your-regression-model---dummy-variables"><i class="fa fa-check"></i><b>7.6.5</b> Extending your regression model - Dummy Variables</a></li>
<li class="chapter" data-level="7.6.6" data-path="explaining-spatial-patterns.html"><a href="explaining-spatial-patterns.html#task-investigating-further---adding-more-explanatory-variables-into-a-multiple-regression-model"><i class="fa fa-check"></i><b>7.6.6</b> TASK: Investigating Further - Adding More Explanatory Variables into a multiple regression model</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="explaining-spatial-patterns.html"><a href="explaining-spatial-patterns.html#task-3---spatial-non-stationarity-and-geographically-weighted-regression-models-gwr"><i class="fa fa-check"></i><b>7.7</b> Task 3 - Spatial Non-stationarity and Geographically Weighted Regression Models (GWR)</a></li>
<li class="chapter" data-level="7.8" data-path="explaining-spatial-patterns.html"><a href="explaining-spatial-patterns.html#feedback-6"><i class="fa fa-check"></i><b>7.8</b> Feedback</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="advanced-raster-analysis.html"><a href="advanced-raster-analysis.html"><i class="fa fa-check"></i><b>8</b> Advanced raster analysis</a>
<ul>
<li class="chapter" data-level="8.1" data-path="advanced-raster-analysis.html"><a href="advanced-raster-analysis.html#learning-objectives-1"><i class="fa fa-check"></i><b>8.1</b> Learning objectives</a></li>
<li class="chapter" data-level="8.2" data-path="advanced-raster-analysis.html"><a href="advanced-raster-analysis.html#homework-7"><i class="fa fa-check"></i><b>8.2</b> Homework</a></li>
<li class="chapter" data-level="8.3" data-path="advanced-raster-analysis.html"><a href="advanced-raster-analysis.html#recommended-listening-7"><i class="fa fa-check"></i><b>8.3</b> Recommended listening 🎧</a></li>
<li class="chapter" data-level="8.4" data-path="advanced-raster-analysis.html"><a href="advanced-raster-analysis.html#introduction-7"><i class="fa fa-check"></i><b>8.4</b> Introduction</a></li>
<li class="chapter" data-level="8.5" data-path="advanced-raster-analysis.html"><a href="advanced-raster-analysis.html#gitignore"><i class="fa fa-check"></i><b>8.5</b> .gitignore</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="advanced-raster-analysis.html"><a href="advanced-raster-analysis.html#remote-sensing-background-required"><i class="fa fa-check"></i><b>8.5.1</b> Remote sensing background (required)</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="advanced-raster-analysis.html"><a href="advanced-raster-analysis.html#data-2"><i class="fa fa-check"></i><b>8.6</b> Data</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="advanced-raster-analysis.html"><a href="advanced-raster-analysis.html#shapefile"><i class="fa fa-check"></i><b>8.6.1</b> Shapefile</a></li>
<li class="chapter" data-level="8.6.2" data-path="advanced-raster-analysis.html"><a href="advanced-raster-analysis.html#raster-data-landsat"><i class="fa fa-check"></i><b>8.6.2</b> Raster data (Landsat)</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="advanced-raster-analysis.html"><a href="advanced-raster-analysis.html#processing-raster-data"><i class="fa fa-check"></i><b>8.7</b> Processing raster data</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="advanced-raster-analysis.html"><a href="advanced-raster-analysis.html#loading"><i class="fa fa-check"></i><b>8.7.1</b> Loading</a></li>
<li class="chapter" data-level="8.7.2" data-path="advanced-raster-analysis.html"><a href="advanced-raster-analysis.html#resampling"><i class="fa fa-check"></i><b>8.7.2</b> Resampling</a></li>
<li class="chapter" data-level="8.7.3" data-path="advanced-raster-analysis.html"><a href="advanced-raster-analysis.html#clipping"><i class="fa fa-check"></i><b>8.7.3</b> Clipping</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="advanced-raster-analysis.html"><a href="advanced-raster-analysis.html#data-exploration"><i class="fa fa-check"></i><b>8.8</b> Data exploration</a>
<ul>
<li class="chapter" data-level="8.8.1" data-path="advanced-raster-analysis.html"><a href="advanced-raster-analysis.html#more-loading-and-manipulating"><i class="fa fa-check"></i><b>8.8.1</b> More loading and manipulating</a></li>
<li class="chapter" data-level="8.8.2" data-path="advanced-raster-analysis.html"><a href="advanced-raster-analysis.html#plotting-data"><i class="fa fa-check"></i><b>8.8.2</b> Plotting data</a></li>
<li class="chapter" data-level="8.8.3" data-path="advanced-raster-analysis.html"><a href="advanced-raster-analysis.html#data-similarity"><i class="fa fa-check"></i><b>8.8.3</b> Data similarity</a></li>
</ul></li>
<li class="chapter" data-level="8.9" data-path="advanced-raster-analysis.html"><a href="advanced-raster-analysis.html#basic-raster-calculations"><i class="fa fa-check"></i><b>8.9</b> Basic raster calculations</a>
<ul>
<li class="chapter" data-level="8.9.1" data-path="advanced-raster-analysis.html"><a href="advanced-raster-analysis.html#ndvi"><i class="fa fa-check"></i><b>8.9.1</b> NDVI</a></li>
<li class="chapter" data-level="8.9.2" data-path="advanced-raster-analysis.html"><a href="advanced-raster-analysis.html#ndvi-function"><i class="fa fa-check"></i><b>8.9.2</b> NDVI function</a></li>
</ul></li>
<li class="chapter" data-level="8.10" data-path="advanced-raster-analysis.html"><a href="advanced-raster-analysis.html#advanced-raster-calculations"><i class="fa fa-check"></i><b>8.10</b> Advanced raster calculations</a>
<ul>
<li class="chapter" data-level="8.10.1" data-path="advanced-raster-analysis.html"><a href="advanced-raster-analysis.html#calculating-tempearture-from-landsat-data"><i class="fa fa-check"></i><b>8.10.1</b> Calculating tempearture from Landsat data</a></li>
</ul></li>
<li class="chapter" data-level="8.11" data-path="advanced-raster-analysis.html"><a href="advanced-raster-analysis.html#calucating-urban-area-from-landsat-data"><i class="fa fa-check"></i><b>8.11</b> Calucating urban area from Landsat data</a></li>
<li class="chapter" data-level="8.12" data-path="advanced-raster-analysis.html"><a href="advanced-raster-analysis.html#urban-area-and-temperature-relationship"><i class="fa fa-check"></i><b>8.12</b> Urban area and temperature relationship</a></li>
<li class="chapter" data-level="8.13" data-path="advanced-raster-analysis.html"><a href="advanced-raster-analysis.html#statistical-summary"><i class="fa fa-check"></i><b>8.13</b> Statistical summary</a></li>
<li class="chapter" data-level="8.14" data-path="advanced-raster-analysis.html"><a href="advanced-raster-analysis.html#lsoamsoa-stats"><i class="fa fa-check"></i><b>8.14</b> LSOA/MSOA stats</a></li>
<li class="chapter" data-level="8.15" data-path="advanced-raster-analysis.html"><a href="advanced-raster-analysis.html#mapping"><i class="fa fa-check"></i><b>8.15</b> Mapping</a></li>
<li class="chapter" data-level="8.16" data-path="advanced-raster-analysis.html"><a href="advanced-raster-analysis.html#bivariate-mapping-optional"><i class="fa fa-check"></i><b>8.16</b> Bivariate mapping (optional)</a>
<ul>
<li class="chapter" data-level="8.16.1" data-path="advanced-raster-analysis.html"><a href="advanced-raster-analysis.html#map-notes"><i class="fa fa-check"></i><b>8.16.1</b> Map notes</a></li>
</ul></li>
<li class="chapter" data-level="8.17" data-path="advanced-raster-analysis.html"><a href="advanced-raster-analysis.html#considerations"><i class="fa fa-check"></i><b>8.17</b> Considerations</a></li>
<li class="chapter" data-level="8.18" data-path="advanced-raster-analysis.html"><a href="advanced-raster-analysis.html#references"><i class="fa fa-check"></i><b>8.18</b> References</a></li>
<li class="chapter" data-level="8.19" data-path="advanced-raster-analysis.html"><a href="advanced-raster-analysis.html#remote-sensing-background-optional"><i class="fa fa-check"></i><b>8.19</b> Remote sensing background (optional)</a></li>
<li class="chapter" data-level="8.20" data-path="advanced-raster-analysis.html"><a href="advanced-raster-analysis.html#feedback-7"><i class="fa fa-check"></i><b>8.20</b> Feedback</a></li>
</ul></li>
<li class="part"><span><b>Extra</b></span></li>
<li class="chapter" data-level="" data-path="module-resources.html"><a href="module-resources.html"><i class="fa fa-check"></i>Module resources</a>
<ul>
<li class="chapter" data-level="8.21" data-path="module-resources.html"><a href="module-resources.html#markscheme"><i class="fa fa-check"></i><b>8.21</b> Markscheme</a></li>
<li class="chapter" data-level="8.22" data-path="module-resources.html"><a href="module-resources.html#events-meet-other-spatial-data-professionals"><i class="fa fa-check"></i><b>8.22</b> Events / meet other spatial data professionals</a></li>
<li class="chapter" data-level="8.23" data-path="module-resources.html"><a href="module-resources.html#cool-stuff-to-explore"><i class="fa fa-check"></i><b>8.23</b> Cool stuff to explore</a></li>
<li class="chapter" data-level="8.24" data-path="module-resources.html"><a href="module-resources.html#booksreading-resources"><i class="fa fa-check"></i><b>8.24</b> Books/reading resources</a></li>
<li class="chapter" data-level="8.25" data-path="module-resources.html"><a href="module-resources.html#new-developments"><i class="fa fa-check"></i><b>8.25</b> New developments</a>
<ul>
<li class="chapter" data-level="8.25.1" data-path="module-resources.html"><a href="module-resources.html#twitter"><i class="fa fa-check"></i><b>8.25.1</b> Twitter</a></li>
</ul></li>
<li class="chapter" data-level="8.26" data-path="module-resources.html"><a href="module-resources.html#data-3"><i class="fa fa-check"></i><b>8.26</b> Data</a></li>
<li class="chapter" data-level="8.27" data-path="module-resources.html"><a href="module-resources.html#data-lists-1"><i class="fa fa-check"></i><b>8.27</b> Data lists</a></li>
</ul></li>
<li class="divider"></li>
<li><center>
  <a rel="license" href="./external-usage.html#license">
    License: CC-BY-SA<br>
    <i class = "fab fa-creative-commons fa-2x"></i>
    <i class = "fab fa-creative-commons-by fa-2x"></i>
    <i class = "fab fa-creative-commons-sa fa-2x"></i>
  </a>
</li></center>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">CASA0005 Geographic Information Systems and Science</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="introduction-to-r" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">Chapter 2</span> Introduction to R<a href="introduction-to-r.html#introduction-to-r" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="learning-outcomes-1" class="section level2 hasAnchor" number="2.1">
<h2><span class="header-section-number">2.1</span> Learning outcomes<a href="introduction-to-r.html#learning-outcomes-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>By the end of this practical you should be able to:</p>
<ol style="list-style-type: decimal">
<li>Execute basic processing in R</li>
<li>Examine, clean and manipulate comma seperate value (<code>.csv</code>) data</li>
<li>Examine, clean and manipulate and plot spatial (<code>.shp</code>) data</li>
<li>Produce interactive maps</li>
<li>Evaluate the benefits of different data manipulation and mapping techniques</li>
</ol>
</div>
<div id="homework-1" class="section level2 hasAnchor" number="2.2">
<h2><span class="header-section-number">2.2</span> Homework<a href="introduction-to-r.html#homework-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Outside of our schedulded sessions you should be doing around 12 hours of extra study per week. Feel free to follow your own GIS interests, but good places to start include the following:</p>
<div class="infobox assignment">
<p><strong>Exam</strong></p>
<p>Each week we will provide a short task to test your knowledge, these should be used to guide your study for the final exam.</p>
<p>The task is to join some non spatial data to some spatial data and wrangle it.</p>
<p>You need calcuate the average percent of science students (in all) grades per county meeting the required standards and produce a map to show where the Country averages are above or below the State of Washington average.</p>
<ul>
<li><p><a href="https://hub.arcgis.com/datasets/kingcounty::washington-counties-with-natural-shoreline-washsh-area/explore?location=47.272700%2C-120.740400%2C7.67">Download Washing Counties</a></p></li>
<li><p><a href="https://data.wa.gov/Education/Report-Card-Assessment-Data-2018-19-School-Year/5y3z-mgxd">Download school report card data</a></p></li>
</ul>
</div>
<div class="infobox note">
<p><strong>Reading</strong></p>
<p>This week:</p>
<ul>
<li><p><a href="https://geocompr.robinlovelace.net/spatial-class.html">Chapter 2 “Geographic data in R”</a> from Geocomputation with R by Lovelace, Nowosad and Muenchow (2020).</p></li>
<li><p><a href="https://onlinelibrary.wiley.com/doi/epdf/10.1046/j.1444-2892.2000.00031.x">How to Write a Paper for Publication</a> by Rosenfeldt et al. (2000).</p></li>
</ul>
<p><strong>Watching</strong></p>
<ul>
<li><p><a href="https://rstudio.cloud/learn/primers/1.2">The series of short (2min) videos produced by RStudio on programming basics</a></p></li>
<li><p><a href="https://www.youtube.com/watch?v=9YTNYT1maa4">Hadley Wickham’s Keynote from the European Molecular Biology Laboratory (EMBL)</a>. This will be the same for a few weeks.</p></li>
</ul>
<p>Remember this is just a starting point, explore the <a href="https://rl.talis.com/3/ucl/lists/139FBAF8-DACD-60FB-8BDC-E9C9E09BA885.html?lang=en-GB&amp;login=1">reading list</a>, practical and lecture for more ideas.</p>
</div>
</div>
<div id="recommended-listening-1" class="section level2 hasAnchor" number="2.3">
<h2><span class="header-section-number">2.3</span> Recommended listening 🎧<a href="#recommended-listening-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Some of these practicals are long, take regular breaks and have a listen to some of our fav tunes each week.</p>
<p><a href="https://open.spotify.com/album/7jGNAMzrW5HMXdxl9XyBMG">Andy</a>. Dermot Kennedy, might give you the chills with his pure voice. I saw him live last year at All Points East in London. Orginally was well known from the Spotify Discover Weekly where he used to self publish songs.</p>
<p><a href="https://open.spotify.com/album/5yAXUpsKaby5IcXgzrNFAw">Adam</a>. Change of genre this week, but this will still melt your brains! I first saw this band in Cambridge in about 2004 when we were both still young! 16 years later, they’re now a massive platinum-selling Rock juggernaut with their latest singles bothering the playlists of the world’s most popular radio stations and their live-shows conquering the biggest festivals. Mon the Biff. It is of course Biffy Clyro! Here’s their latest album - A Celebration of Endings -</p>
</div>
<div id="introduction-1" class="section level2 hasAnchor" number="2.4">
<h2><span class="header-section-number">2.4</span> Introduction<a href="introduction-to-r.html#introduction-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This practical is <strong>LONG</strong> but it will take you from not knowing much about R to making freaking cool interactive maps in one practical. As you can imagine, this will be a steep learning curve.</p>
<p>I will give you all the code you need, it’s your job to read through the text very carefully and try to understand what bits of code are doing as you go.</p>
<p>There will be bits of code you don’t fully understand. Don’t worry, the key is to revisit later and try to work out what is going on then. Learning R is a long and iterative process and this is just the start…</p>
<p>If you want to learn more about R and indeed download the latest version for your own use, then visit the <a href="http://www.r-project.org/">R project pages</a></p>
<p>The Wikipedia page for those who want to know a little of the history of R can be found <a href="http://en.wikipedia.org/wiki/R_(programming_language)">here</a></p>
<p>There is an almost endless supply of good R tutorials on the web. If you get stuck or want to learn even more R (and why would you not want to?!), I’d recommend trying some of the following R Tutorial websites:</p>
<ul>
<li><p><a href="http://www.statmethods.net/index.html" class="uri">http://www.statmethods.net/index.html</a></p></li>
<li><p><a href="http://www.r-tutor.com/" class="uri">http://www.r-tutor.com/</a></p></li>
<li><p><a href="http://www.cyclismo.org/tutorial/R/index.html" class="uri">http://www.cyclismo.org/tutorial/R/index.html</a></p></li>
<li><p><a href="http://www.cookbook-r.com/" class="uri">http://www.cookbook-r.com/</a></p></li>
</ul>
<p>If you want to really be up to date with the state of the art in R, then <a href="https://bookdown.org/">bookdown</a> is a fantastic resource. It features <strong>free</strong> books by some of the pre-eminent names in the R scene — I would urge you to go and take a look.</p>
<div id="online-forums-are-your-friend" class="section level3 hasAnchor" number="2.4.1">
<h3><span class="header-section-number">2.4.1</span> Online forums are your friend!!<a href="introduction-to-r.html#online-forums-are-your-friend" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>With almost every problem you encounter with R, someone else will have had the same problem before you and posted it on a forum –– someone will then post a solution below.</p>
<p>My usual route is to Google the problem and I’ll then be directed to a post, usually on Stack Overflow, Stack Exchange or Cross Validated. When doing so try to think about the minimal working (or not working) example (MWE), by this i mean remove anything very specific to your problem. I’ve rarely not found a solution to a problem this way.</p>
</div>
<div id="health-warning" class="section level3 hasAnchor" number="2.4.2">
<h3><span class="header-section-number">2.4.2</span> Health warning<a href="introduction-to-r.html#health-warning" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Beware of posting questions on these forums yourself – contributors to these forums (especially the R ones!), whilst almost always extremely knowledgeable about R, have a bit of a reputation for being insert familiar pejorative term for less-than-polite-human-being here! As you might expect, people who have enough time to become total experts in R, have little time to work on their social skills!! Fortunately though, some other poor chump has usually taken that hit for you and you can still find a useful answer to your problem.</p>
<p>If you are specifically more interested in the spatial side of R, then Alex Singleton and Chris Brunsdon at the Universities of Liverpool and Maynooth also have a number of very useful R Spatial Tutorials – <a href="http://rpubs.com/alexsingleton/" class="uri">http://rpubs.com/alexsingleton/</a> &amp; <a href="http://rpubs.com/chrisbrunsdon/" class="uri">http://rpubs.com/chrisbrunsdon/</a></p>
<p>Robin Lovelace in Leeds is also frequently at the bleeding edge of developments in R spatial stuff, so keep an eye on his <a href="http://robinlovelace.net/">website</a>. Robin has also made a book on GeoComputation in R, which you should definitely read! — <a href="https://geocompr.robinlovelace.net/" class="uri">https://geocompr.robinlovelace.net/</a></p>
<p>These websites are also very very good: <a href="https://pakillo.github.io/R-GIS-tutorial/" class="uri">https://pakillo.github.io/R-GIS-tutorial/</a> and <a href="http://www.maths.lancs.ac.uk/~rowlings/Teaching/UseR2012/cheatsheet.html" class="uri">http://www.maths.lancs.ac.uk/~rowlings/Teaching/UseR2012/cheatsheet.html</a></p>
</div>
<div id="r-and-rstudio" class="section level3 hasAnchor" number="2.4.3">
<h3><span class="header-section-number">2.4.3</span> R and RStudio<a href="introduction-to-r.html#r-and-rstudio" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>When you download and install R, you get the R Graphical User Interface (GUI) as standard (below). This is fine and some purists prefer using the clean, unfussy command-line original, but it has some limitations such as no graphical way to view data tables or keep track of what is in your working directory (there are a number of others too).</p>
<p><img src="prac2_images/R.png" width="500px" style="display: block; margin: auto;" /></p>
<p>Fortunately there are a number of software environments that have been developed for R to make it a little more user-friendly; the best of these by a long way is RStudio. RStudio can be downloaded for free from <a href="https://www.rstudio.com/" class="uri">https://www.rstudio.com/</a>. We covered the RStudio layout last week.</p>
</div>
<div id="getting-started-1" class="section level3 hasAnchor" number="2.4.4">
<h3><span class="header-section-number">2.4.4</span> Getting started<a href="introduction-to-r.html#getting-started-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>If you are some kind of masochist, you are welcome to use the bundled R GUI for all of your work. If pain is not your thing, then for this practical (and future practicals) I will assume that you are using RStudio.</p>
<ol style="list-style-type: decimal">
<li>From the start menu on your computer, find and run RStudio</li>
</ol>
<p>Once RStudio has opened, the first thing we will do is create a new project – projects enable you to organise your work effectively and store all of the files you create and work with for a particular task.</p>
<ol style="list-style-type: decimal">
<li><p>To create a new project (and this will vary a little depending on the version of RStudio you are using) select File &gt; New Project</p></li>
<li><p>Select Start a project in a brand new working directory and create a new project in a directory of a new ‘wk2’ directory on your N: drive:</p></li>
</ol>
<p><img src="prac2_images/r_newproject.png" width="500px" style="display: block; margin: auto;" /></p>
<p>My file directory (the second box here) will be different to yours as this is my teaching resources folder. Keep yours simple <code>N:/GIS/wk2</code>.</p>
<p>Setting up a project is extremely useful as it lets you easily access your data and files…for example….the flytipping <code>.csv</code> we used last week is stored at the file path</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="introduction-to-r.html#cb29-1" aria-hidden="true" tabindex="-1"></a>mycsv <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;C:/Users/Andy/OneDrive - University College London/Teaching/CASA0005/2020_2021/CASA0005repo/Prac1_data/fly_tipping_borough_edit.csv&quot;&quot;)  </span></span></code></pre></div>
<p>However as i’ve set my R project up in the CASA0005repo folder with different data folders for each week i can just use:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="introduction-to-r.html#cb30-1" aria-hidden="true" tabindex="-1"></a>mycsv <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;Prac1_data/fly_tipping_borough_edit.csv&quot;</span>)  </span></code></pre></div>
<p>If i had the <code>.csv</code> file in the same folder as my project i could just use</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="introduction-to-r.html#cb31-1" aria-hidden="true" tabindex="-1"></a>mycsv <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;fly_tipping_borough_edit.csv&quot;</span>)  </span></code></pre></div>
<p>You can run this in the Console area now or within a script which we will now go over…</p>
<p>I’d strongly recommend you think about how you will store data within your project. Is it sensible to just dump all your data into the project folder or perahps create a new folder (either in R) or how you would normally do so in Windows / OS X and keep your raw data in that folder…like i have done…Here you can see that i’m in my project folder (red box on the right) and i’ve made new folders for all my data (each practical here) and images that are shown throuhgout….nice and organised!</p>
<p><img src="prac2_images/file_storage.png" width="500px" style="display: block; margin: auto;" /></p>
</div>
<div id="basics-2" class="section level3 hasAnchor" number="2.4.5">
<h3><span class="header-section-number">2.4.5</span> Basics<a href="introduction-to-r.html#basics-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li>R has a very steep learning curve, but hopefully it won’t take long to get your head around the basics. For example, at its most simple R can be used as a calculator. In the console window (bottom left), just type the following and press enter:</li>
</ol>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="introduction-to-r.html#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">+</span><span class="dv">5</span></span></code></pre></div>
<pre><code>## [1] 6</code></pre>
<p>or</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="introduction-to-r.html#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span><span class="sc">*</span><span class="dv">5</span><span class="sc">^</span><span class="dv">2</span></span></code></pre></div>
<pre><code>## [1] 100</code></pre>
<p>As you can see R performs these calculations instantly and prints the results in the console. This is useful for quick calculations but less useful for writing scripts requiring multiple operations or saving these for future use.</p>
<ol style="list-style-type: decimal">
<li><p>To save your scripts, you should create a new R Script file. Do this now: Select File &gt; New File &gt; R Script.</p></li>
<li><p>The R Script should open up on the top-left of your GUI. <strong>From now on type everything in this R script file and save it</strong></p></li>
</ol>
</div>
<div id="scripts-and-some-basic-commands" class="section level3 hasAnchor" number="2.4.6">
<h3><span class="header-section-number">2.4.6</span> Scripts and some basic commands<a href="introduction-to-r.html#scripts-and-some-basic-commands" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li><p>Usually one of the first things to do when starting a new R Script is to check that you are in the correct working directory. This is important especially if you are working on multiple projects in different locations. To do this type the following into your new empty R Script:</p></li>
<li><p>To run this line, hold Ctrl (Cmd on a Mac) and press the Return(↲) key (if you are in the standard R installation, you would run your script with Ctrl R). You should now see your current working directory appear in the console.</p></li>
<li><p>Because of the new project we have already set up, this working directory should be correct, but if for any reason we wanted to change the working directory, we would use the <code>setwd()</code> function. For example, we wanted to change our directory to the documents folder on the C drive, we could run (don’t do this now):</p></li>
</ol>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="introduction-to-r.html#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">&quot;C:/Documents&quot;</span>)</span></code></pre></div>
<ol style="list-style-type: decimal">
<li><p>When we are sure we are working in the correct working directory, we can save our script by clicking on the save icon on the script tab. Save your script as something like “wk2_part1” and you will see it appear in your files window on the right hand side. As you build up a document of R code, you should get into the habit of saving your script periodically in case of an unexpected software crash.</p></li>
<li><p>We can now begin to write a script without the need to run each line every time we press enter. In the script editor type:</p></li>
</ol>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="introduction-to-r.html#cb37-1" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb37-2"><a href="introduction-to-r.html#cb37-2" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb37-3"><a href="introduction-to-r.html#cb37-3" aria-hidden="true" tabindex="-1"></a>C <span class="ot">&lt;-</span> A<span class="sc">+</span>B</span>
<span id="cb37-4"><a href="introduction-to-r.html#cb37-4" aria-hidden="true" tabindex="-1"></a>C</span></code></pre></div>
<pre><code>## [1] 3</code></pre>
<ol style="list-style-type: decimal">
<li><p>Select (highlight) the three lines and run all three lines with Ctrl Return(↲). You will notice the lines appear in the console (the other window). If you type C and press enter in the console (C and then ctrl return in the script window) you should have the number 3 appear. From now on I recommend you type all the commands below in the script first and then run them. Copying and pasting from this document won’t necessarily work.</p></li>
<li><p>You will also notice that in RStudio, values A, B and C will appear in your workspace window (top right). These variables are stored in memory for future use. Try giving A and B different values and see what happens. What about if you use lower case letters?</p></li>
<li><p>You have just demonstrated one of the powerful aspects of R, which is that it is an <strong>object oriented</strong> programming language. A, B and C are all objects that have been assigned a value with the &lt;- symbol (you can also use the = sign, but it operates slightly differently to &lt;- in R, plus the arrow assignment has become standard over the years. Use <strong>alt -</strong> to type it automatically). This principle underlies the whole language and enables users to create ever more complex objects as they progress through their analysis. If you type:</p></li>
</ol>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="introduction-to-r.html#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ls</span>()</span></code></pre></div>
<pre><code>## [1] &quot;A&quot;        &quot;all_pkgs&quot; &quot;B&quot;        &quot;C&quot;        &quot;con&quot;      &quot;mycsv&quot;    &quot;session&quot; 
## [8] &quot;shape&quot;</code></pre>
<p>R will produce a list of objects that are currently active.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="introduction-to-r.html#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(A)</span></code></pre></div>
<p>will remove the object A from the workspace (do <code>ls()</code> again to check this or look in your workspace window).</p>
</div>
<div id="functions" class="section level3 hasAnchor" number="2.4.7">
<h3><span class="header-section-number">2.4.7</span> Functions<a href="introduction-to-r.html#functions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li>Both <code>rm()</code> and <code>ls()</code> are known as functions. Functions are the other fundamental aspect to the R language. Functions can be thought of as single or multiple calculations that you apply to objects. They generally take the form of…(don’t run these)</li>
</ol>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="introduction-to-r.html#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span>(object, argument1, argument2, argument3)</span></code></pre></div>
<p>Where the object is some form of data and the arguments parameterise what the function will do.</p>
<p>You could save the ouput to a new object using something like…</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="introduction-to-r.html#cb43-1" aria-hidden="true" tabindex="-1"></a>X<span class="ot">&lt;-</span><span class="cf">function</span>(data, argument1, argument2, argument3)</span></code></pre></div>
<ol style="list-style-type: decimal">
<li>You can write your own functions to carry out tasks (and we’ll come onto that in subsequent practical sessions), but normally you will just used one of the virtually infinite number of functions that other people have already written for us.</li>
</ol>
</div>
<div id="basic-plotting" class="section level3 hasAnchor" number="2.4.8">
<h3><span class="header-section-number">2.4.8</span> Basic plotting<a href="introduction-to-r.html#basic-plotting" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>One common function is the <code>plot()</code> function for displaying data as a graphical output. Add these lines to your script and run them as before and you can see some <code>plot()</code> outputs:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="introduction-to-r.html#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co">#create some datasets, first a vector of 1-100 and 101-200</span></span>
<span id="cb44-2"><a href="introduction-to-r.html#cb44-2" aria-hidden="true" tabindex="-1"></a>Data1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>)</span>
<span id="cb44-3"><a href="introduction-to-r.html#cb44-3" aria-hidden="true" tabindex="-1"></a>Data2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">101</span><span class="sc">:</span><span class="dv">200</span>)</span>
<span id="cb44-4"><a href="introduction-to-r.html#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot the data</span></span>
<span id="cb44-5"><a href="introduction-to-r.html#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Data1, Data2, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="CASA0005_files/figure-html/unnamed-chunk-70-1.png" width="672" /></p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="introduction-to-r.html#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co">#just for fun, create some more, this time some normally distributed</span></span>
<span id="cb45-2"><a href="introduction-to-r.html#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="co">#vectors of 100 numbers</span></span>
<span id="cb45-3"><a href="introduction-to-r.html#cb45-3" aria-hidden="true" tabindex="-1"></a>Data3 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">53</span>, <span class="at">sd=</span><span class="dv">34</span>)</span>
<span id="cb45-4"><a href="introduction-to-r.html#cb45-4" aria-hidden="true" tabindex="-1"></a>Data4 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">64</span>, <span class="at">sd=</span><span class="dv">14</span>)</span>
<span id="cb45-5"><a href="introduction-to-r.html#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="co">#plot</span></span>
<span id="cb45-6"><a href="introduction-to-r.html#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Data3, Data4, <span class="at">col=</span><span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="CASA0005_files/figure-html/unnamed-chunk-71-1.png" width="672" /></p>
<ol style="list-style-type: decimal">
<li>In the code above, you will have noticed the <code>#</code> symbol. This signifies that whatever comes after it on that line is a comment. Comments are ignored by the R console and they allow you to annotate your code so that you know what it is doing. It is good programming practice to comment your code extensively so that you can keep track of what your scripts are for.</li>
</ol>
<p><strong>Warning</strong> Heed our advice now and comment your code it will save you time in the future!</p>
</div>
<div id="help" class="section level3 hasAnchor" number="2.4.9">
<h3><span class="header-section-number">2.4.9</span> Help<a href="introduction-to-r.html#help" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li>The previous lines of code also demonstrated a number of functions: <code>c()</code> concatenates a string of numbers together into a vector. 1:100 means produce the integers between and including 1:100, the <code>plot()</code> function plots the two data objects and includes a parameter to change the colour of the points. To understand what a function does, you can consult the R Help system. Simply type a question mark and then the function name; for example:</li>
</ol>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="introduction-to-r.html#cb46-1" aria-hidden="true" tabindex="-1"></a>?plot</span></code></pre></div>
<p><img src="prac2_images/rhelp.png" width="300px" style="display: block; margin: auto;" /></p>
<ol style="list-style-type: decimal">
<li>In RStudio you will see the help file appear in the Help window in the bottom right of the GUI. Here you can also search for the help files for other functions in the search bar.</li>
</ol>
</div>
<div id="data-structures" class="section level3 hasAnchor" number="2.4.10">
<h3><span class="header-section-number">2.4.10</span> Data structures<a href="introduction-to-r.html#data-structures" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li>Objects in R can exist as a number of different data structures. These include a <strong>matrix</strong>, an <strong>array</strong>, a <strong>vector</strong>, a <strong>data frame</strong> and a <strong>list</strong>.</li>
</ol>
<p>The main criteria for division of these structures is data type homogeneity.</p>
<p>A vector, matrix and array must only contain data of the <strong>same type</strong> (e.g. numeric or text)</p>
<p>A list or data frame can contain a mixture of data types (e.g. numeric and text).</p>
<p>Further divisions are then made based on the number of dimensions (1D, 2D, 3D or more) each can have…</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-74"></span>
<img src="prac2_images/data_structures.png" alt="R's most common data structures are vectors, matrices, arrays, lists and data frames. Source: [ Figure 3.6, NUS BACT](https://nusbasdata.wordpress.com/2018/01/06/r-tutorial-4-data-structures/)" width="450px" />
<p class="caption">
Figure 2.1: R’s most common data structures are vectors, matrices, arrays, lists and data frames. Source: <a href="https://nusbasdata.wordpress.com/2018/01/06/r-tutorial-4-data-structures/">Figure 3.6, NUS BACT</a>
</p>
</div>
<p>For the purposes of this practical we will focus on data frames. These are the most flexible data format in R (although tibbles are now becoming popular as well — they are just more flexible versions of data frames, for example they can have a list as a column). Data frames can be conceptualised in a similar way to a spreadsheet with data held in rows and columns. They are the most commonly used object type in R and the most straightforward to create from the two vector objects we just created.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="introduction-to-r.html#cb47-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Data1, Data2)</span>
<span id="cb47-2"><a href="introduction-to-r.html#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(df, <span class="at">col=</span><span class="st">&quot;green&quot;</span>)</span></code></pre></div>
<p><img src="CASA0005_files/figure-html/unnamed-chunk-75-1.png" width="672" /></p>
<ol style="list-style-type: decimal">
<li>If you have a very large data frame (thousands or millions of rows) it is useful to see only a selection of these. There are several ways of doing this:</li>
</ol>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="introduction-to-r.html#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb48-2"><a href="introduction-to-r.html#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="co">#show the first 10 and then last 10 rows of data in df...</span></span>
<span id="cb48-3"><a href="introduction-to-r.html#cb48-3" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb48-4"><a href="introduction-to-r.html#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code></pre></div>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="introduction-to-r.html#cb49-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb49-2"><a href="introduction-to-r.html#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tail</span>()</span></code></pre></div>
<div class="infobox warning">
<p>You might have noticed the syntax (code) <code>%&gt;%</code>, this is called a <strong>pipe</strong> and is an operator is part from the <code>magrittr</code> package. <code>magrittr</code> is an entirely new way of thinking about R syntax that cleraly expresses a sequence of multiple operations. It is useful to think of the pipe operator as simply meaning “then”. Do this <strong>THEN</strong> do this <strong>THEN</strong> do that.</p>
<p>In R version 4.1 there is a new pipe <code>|&gt;</code>. It is exactly at the same as <code>%&gt;%</code> but means there is no reliance on the <code>magrittr</code> package. The good news is they can <em>mostly</em> be used interchangeably. I</p>
</div>
<p>You can also view elements of your data frame in RStudio by simply clicking on it in the top-right Environment window:</p>
<p><img src="prac2_images/dataview.png" width="800px" style="display: block; margin: auto;" /></p>
</div>
<div id="elements-of-a-data-frame" class="section level3 hasAnchor" number="2.4.11">
<h3><span class="header-section-number">2.4.11</span> Elements of a data frame<a href="introduction-to-r.html#elements-of-a-data-frame" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li>When programming you will frequently want to refer to different elements in a data frame or a vector/list. To select elements of a data frame, or subset it, you can refer specifically to ranges or elements of rows and columns. These are accessed using the single square bracket operator [], with the form:</li>
</ol>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="introduction-to-r.html#cb50-1" aria-hidden="true" tabindex="-1"></a>data.frame[row,column]</span></code></pre></div>
<p>Rows are always referenced first, before the comma, columns second, after the comma.</p>
<ol style="list-style-type: decimal">
<li>Try the subsetting your df data frame with the following commands to see what is returned:</li>
</ol>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="introduction-to-r.html#cb51-1" aria-hidden="true" tabindex="-1"></a>df[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="dv">1</span>]</span>
<span id="cb51-2"><a href="introduction-to-r.html#cb51-2" aria-hidden="true" tabindex="-1"></a>df[<span class="dv">5</span><span class="sc">:</span><span class="dv">15</span>,]</span>
<span id="cb51-3"><a href="introduction-to-r.html#cb51-3" aria-hidden="true" tabindex="-1"></a>df[<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">6</span>),<span class="dv">2</span>]</span>
<span id="cb51-4"><a href="introduction-to-r.html#cb51-4" aria-hidden="true" tabindex="-1"></a>df[,<span class="dv">1</span>]</span></code></pre></div>
<ol style="list-style-type: decimal">
<li>You will note that the column headings are the names of the original objects creating the data frame. We can change these using the <code>rename()</code> function from <code>dplyr</code> that is loaded as part of the <code>tidyverse</code> package, we will come to this next:</li>
</ol>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="introduction-to-r.html#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb52-2"><a href="introduction-to-r.html#cb52-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb52-3"><a href="introduction-to-r.html#cb52-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">column1 =</span> Data1, <span class="at">column2=</span>Data2)</span></code></pre></div>
<p><code>dplyr</code> is a grammar of data manipulation, it has multiple verbs that allow you to change your data into a suitable format. These include <code>select()</code>, <code>filter()</code>, <code>summarise()</code>, which can also be applied to groups in datasets using <code>group_by()</code>. <code>dplyr</code> will be used throughout this course.</p>
<p>In the majority of cases you provide some kind of data to <code>dplyr</code> followed by a <code>%&gt;%</code> then a verb (or other function), then another <code>%&gt;%</code> and more verbs of functions if needed. As in the code above you can also assign the output to an object with <code>&lt;-</code>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-82"></span>
<img src="allisonhorst_images/dplyr_wrangling.png" alt="dplyr introduction graphic. Source: [Allison Horst data science and stats illustrations](https://github.com/allisonhorst/stats-illustrations)" width="450pt" />
<p class="caption">
Figure 2.2: dplyr introduction graphic. Source: <a href="https://github.com/allisonhorst/stats-illustrations">Allison Horst data science and stats illustrations</a>
</p>
</div>
<p>To select or refer to columns directly by name, we can either use <code>dplyr</code> again!</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="introduction-to-r.html#cb53-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb53-2"><a href="introduction-to-r.html#cb53-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(column1)</span></code></pre></div>
<p>However, you should be aware of other methods for doing this, as not all spatial data is compatible with <code>dplyr</code> yet, such as raster data, which will be important for next week. So we can also use the <code>$</code> operator, which takes the form <code>data.frame$columnName</code>, e.g.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="introduction-to-r.html#cb54-1" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>column1</span></code></pre></div>
<p>or we can use the double square bracket operator [[]], and refer to our column by name using quotes e.g.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="introduction-to-r.html#cb55-1" aria-hidden="true" tabindex="-1"></a>df[[<span class="st">&quot;column1&quot;</span>]]</span></code></pre></div>
<p>This again is useful if you have a lot of columns and you wish to efficiently extract one of them.</p>
</div>
</div>
<div id="reading-data-into-r" class="section level2 hasAnchor" number="2.5">
<h2><span class="header-section-number">2.5</span> Reading data into R<a href="introduction-to-r.html#reading-data-into-r" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>One of the most tedious things a spatial analyst / data scientist has to do is clean their data so it doesn’t cause problems for the software later. In the past, we would have needed to do this by hand — these days, we can use software to do much of this for us.</p>
<p>I will now give you two options to arrive at a nice cleaned dataset. For this example we are going to use the London Datastore Catalogue.</p>
<p>Go to the London Data store and <a href="https://data.london.gov.uk/dataset/f33fb38c-cb37-48e3-8298-84c0d3cc5a6c">get the Ward Profiles and Atlas</a> and download the excel document for ward profiles.</p>
<div id="old-skool-cleaning" class="section level3 hasAnchor" number="2.5.1">
<h3><span class="header-section-number">2.5.1</span> Old skool cleaning<a href="introduction-to-r.html#old-skool-cleaning" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li><p>Open the <code>ward-profiles-excel-version.xls</code> file in Excel, and save as <code>LondonData.csv</code> into your RProject folder, week 2.</p></li>
<li><p>Open your new <code>.csv</code> file in Excel. There might be some non-numeric values inside numeric columns which will cause problems in your analysis. These need to be removed before proceeding any further. To remove these, you can use the replace function in Excel. In the home tab under ‘Editing’ open up the find and replace dialogue box and enter the following into the find box:</p></li>
</ol>
<p><code>#VALUE!</code> <code>n/a</code></p>
<p>Leave the replace box empty each time and click Replace All to remove these from your file, before saving the file again.</p>
<ol style="list-style-type: decimal">
<li>Once you have cleaned out all of the trixy characters from the file, to read it into R, we will use the <code>read.csv()</code> function:</li>
</ol>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="introduction-to-r.html#cb56-1" aria-hidden="true" tabindex="-1"></a>LondonDataOSK<span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;prac2_data/ward-profiles-excel-version.csv&quot;</span>, </span>
<span id="cb56-2"><a href="introduction-to-r.html#cb56-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">header =</span> <span class="cn">TRUE</span>, </span>
<span id="cb56-3"><a href="introduction-to-r.html#cb56-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">sep =</span> <span class="st">&quot;,&quot;</span>,  </span>
<span id="cb56-4"><a href="introduction-to-r.html#cb56-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">encoding =</span> <span class="st">&quot;latin1&quot;</span>)</span></code></pre></div>
<blockquote>
<p><strong>Note</strong>, I’ve made an R project for all these practicals, which is why my file path starts with <code>prac2_data/</code>. If you save the <code>.csv</code> in the same folder as the <code>.Rproj</code> then you can just use:</p>
</blockquote>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="introduction-to-r.html#cb57-1" aria-hidden="true" tabindex="-1"></a>LondonDataOSK<span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;ward-profiles-excel-version.csv&quot;</span>, </span>
<span id="cb57-2"><a href="introduction-to-r.html#cb57-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">sep=</span><span class="st">&quot;,&quot;</span>)</span></code></pre></div>
<p>If you look at the <code>read.csv()</code> help file - <code>?read.csv</code> - you will see that we can actually include many more parameters when reading in a <code>.csv</code> file. For example, we could read in the same file as follows:</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="introduction-to-r.html#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># by default in R, the file path should be defined with / </span></span>
<span id="cb58-2"><a href="introduction-to-r.html#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="co">#but on a windows file system it is defined with \. </span></span>
<span id="cb58-3"><a href="introduction-to-r.html#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Using \\ instead allows R </span></span>
<span id="cb58-4"><a href="introduction-to-r.html#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="co">#to read the path correctly – alternatively, just use /</span></span>
<span id="cb58-5"><a href="introduction-to-r.html#cb58-5" aria-hidden="true" tabindex="-1"></a>LondonDataOSK<span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;prac2_data/ward-profiles-excel-version.csv&quot;</span>, </span>
<span id="cb58-6"><a href="introduction-to-r.html#cb58-6" aria-hidden="true" tabindex="-1"></a>                         <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">sep =</span> <span class="st">&quot;,&quot;</span>, <span class="at">encoding =</span> <span class="st">&quot;latin1&quot;</span>)</span></code></pre></div>
<p>This would specify that the first row of the file contains header information; and the values in the file are separated with commas (not ; or : as can be the case sometimes).</p>
</div>
<div id="here" class="section level3 hasAnchor" number="2.5.2">
<h3><span class="header-section-number">2.5.2</span> Here<a href="introduction-to-r.html#here" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>However, this is also another more straightforward way to read in files that was devloped in 2017 to make it more intuitive to find and load files using the <code>here</code> package. You need to install and load it:</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="introduction-to-r.html#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;here&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="introduction-to-r.html#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span></code></pre></div>
<p>Think of <code>here()</code> as a command that is just pointing to a file path, to find out where is pointing use…</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="introduction-to-r.html#cb61-1" aria-hidden="true" tabindex="-1"></a>here<span class="sc">::</span><span class="fu">here</span>()</span></code></pre></div>
<p>This is my working directory for this book project! Now i can use this to load my data that is in my practical 2 folder just like this….</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="introduction-to-r.html#cb62-1" aria-hidden="true" tabindex="-1"></a>LondonDataOSK<span class="ot">&lt;-</span> <span class="fu">read.csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;prac2_data&quot;</span>,<span class="st">&quot;ward-profiles-excel-version.csv&quot;</span>), </span>
<span id="cb62-2"><a href="introduction-to-r.html#cb62-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">sep =</span> <span class="st">&quot;,&quot;</span>,  </span>
<span id="cb62-3"><a href="introduction-to-r.html#cb62-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">encoding =</span> <span class="st">&quot;latin1&quot;</span>)</span></code></pre></div>
<p>This just removes any need for ever using a <code>/</code> or <code>\\</code> in your file path. As with everything in code, there is no right way, use what suits you.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-93"></span>
<img src="allisonhorst_images/here.png" alt="here::here() example. Source: [Allison Horst data science and stats illustrations](https://github.com/allisonhorst/stats-illustrations)" width="450pt" />
<p class="caption">
Figure 2.3: here::here() example. Source: <a href="https://github.com/allisonhorst/stats-illustrations">Allison Horst data science and stats illustrations</a>
</p>
</div>
</div>
<div id="new-skool-cleaning" class="section level3 hasAnchor" number="2.5.3">
<h3><span class="header-section-number">2.5.3</span> New skool cleaning<a href="introduction-to-r.html#new-skool-cleaning" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To clean our data as we read it in, we are going to use a package called <code>readr</code> which also comes bundled as part of the <code>tidyverse</code> package.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-94"></span>
<img src="allisonhorst_images/tidyverse_celestial.png" alt="tidyverse introduction graphic. Source: [Allison Horst data science and stats illustrations](https://github.com/allisonhorst/stats-illustrations)" width="450pt" />
<p class="caption">
Figure 2.4: tidyverse introduction graphic. Source: <a href="https://github.com/allisonhorst/stats-illustrations">Allison Horst data science and stats illustrations</a>
</p>
</div>
<p>The <a href="https://www.tidyverse.org/"><code>tidyverse</code></a> is simply a collection of pacakges relevant for data science, containing almost everything you need to become a kick-ass data scientist.</p>
<p>Now let’s use the <code>readr</code> package… that allows loads of data manipulation …for example…</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-95"></span>
<img src="allisonhorst_images/parse_number.png" alt="readr::parse_number() example. Source: [Allison Horst data science and stats illustrations](https://github.com/allisonhorst/stats-illustrations)" width="450pt" />
<p class="caption">
Figure 2.5: readr::parse_number() example. Source: <a href="https://github.com/allisonhorst/stats-illustrations">Allison Horst data science and stats illustrations</a>
</p>
</div>
<p>Here we will use it to just read in a <code>.csv</code> file (directly from the web this time — <code>read.csv</code> can do this too) and clean text characters out from the numeric columns before they cause problems:</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="introduction-to-r.html#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co">#wang the data in straight from the web using read_csv, </span></span>
<span id="cb63-2"><a href="introduction-to-r.html#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="co">#skipping over the &#39;n/a&#39; entries as you go...</span></span>
<span id="cb63-3"><a href="introduction-to-r.html#cb63-3" aria-hidden="true" tabindex="-1"></a>LondonData <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;https://data.london.gov.uk/download/ward-profiles-and-atlas/772d2d64-e8c6-46cb-86f9-e52b4c7851bc/ward-profiles-excel-version.csv&quot;</span>,</span>
<span id="cb63-4"><a href="introduction-to-r.html#cb63-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">locale =</span> <span class="fu">locale</span>(<span class="at">encoding =</span> <span class="st">&quot;latin1&quot;</span>),</span>
<span id="cb63-5"><a href="introduction-to-r.html#cb63-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">na =</span> <span class="st">&quot;n/a&quot;</span>)</span></code></pre></div>
<blockquote>
<p><strong>Note</strong> the use of read_csv here as opposed to read.csv. They are very similar, but read_csv is just a bit better. Read <a href="http://yetanothermathprogrammingconsultant.blogspot.com/2016/12/reading-csv-files-in-r-readcsv-vs.html">this blog post</a> for more information. Also, for those python fans out there —IT’S NOT THE SAME FUNCTION AS READ_CSV IN PYTHON</p>
</blockquote>
<p>What is <code>locale = locale(encoding = "latin1")</code>?…good question…it is basically the encoding of the data (how it is stored). There are a few different formats such as UTF-8 and latin1. In latin1 each character is 1 byte long, in UTF-8 a character can consist of more than 1 byte. To my knowledge the default in R is encoded as latin1, but <code>readr</code> (the package we are using to read in the <code>.csv</code> is UTF-8 so we have to specify it.</p>
</div>
<div id="examining-your-new-data" class="section level3 hasAnchor" number="2.5.4">
<h3><span class="header-section-number">2.5.4</span> Examining your new data<a href="introduction-to-r.html#examining-your-new-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li>Your new data has been read in as a data frame / tibble (remember a tibble is just a data frame with a few extra bells and whistles). If you ever need to check what data type your new data set is, we can use the <code>class()</code> function:</li>
</ol>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="introduction-to-r.html#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(LondonData)</span></code></pre></div>
<pre><code>## [1] &quot;spec_tbl_df&quot; &quot;tbl_df&quot;      &quot;tbl&quot;         &quot;data.frame&quot;</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="introduction-to-r.html#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># or, if you have your old skool data</span></span>
<span id="cb66-2"><a href="introduction-to-r.html#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(LondonDataOSK)</span></code></pre></div>
<p>We can also use the <code>class()</code> function (from base R) within another two functions <code>summarise_all()</code> (from <code>dplyr</code>) and <code>pivot_longer()</code> (from <code>tidyr</code>) to check that our data has been read in correctly and that, for example, numeric data haven’t been read in as text or other variables. Run the following line of code:</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="introduction-to-r.html#cb67-1" aria-hidden="true" tabindex="-1"></a>Datatypelist <span class="ot">&lt;-</span> LondonData <span class="sc">%&gt;%</span> </span>
<span id="cb67-2"><a href="introduction-to-r.html#cb67-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(class) <span class="sc">%&gt;%</span></span>
<span id="cb67-3"><a href="introduction-to-r.html#cb67-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>(), </span>
<span id="cb67-4"><a href="introduction-to-r.html#cb67-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to=</span><span class="st">&quot;All_variables&quot;</span>, </span>
<span id="cb67-5"><a href="introduction-to-r.html#cb67-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to=</span><span class="st">&quot;Variable_class&quot;</span>)</span>
<span id="cb67-6"><a href="introduction-to-r.html#cb67-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-7"><a href="introduction-to-r.html#cb67-7" aria-hidden="true" tabindex="-1"></a>Datatypelist</span></code></pre></div>
<pre><code>## # A tibble: 67 × 2
##    All_variables                      Variable_class
##    &lt;chr&gt;                              &lt;chr&gt;         
##  1 Ward name                          character     
##  2 Old code                           character     
##  3 New code                           character     
##  4 Population - 2015                  numeric       
##  5 Children aged 0-15 - 2015          numeric       
##  6 Working-age (16-64) - 2015         numeric       
##  7 Older people aged 65+ - 2015       numeric       
##  8 % All Children aged 0-15 - 2015    numeric       
##  9 % All Working-age (16-64) - 2015   numeric       
## 10 % All Older people aged 65+ - 2015 numeric       
## # … with 57 more rows</code></pre>
<p>We cover <code>pivot_longer()</code> later in this practical, but for now we’ve simply grouped all our variables into one <strong>LONG</strong> column adding another column that contains the class.</p>
<p>You should see that all columns that should be numbers are read in as numeric. Try reading in LondonData again, but this time without excluding the ‘n/a’ values in the file, e.g.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="introduction-to-r.html#cb69-1" aria-hidden="true" tabindex="-1"></a>LondonData <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;https://data.london.gov.uk/download/ward-profiles-and-atlas/772d2d64-e8c6-46cb-86f9-e52b4c7851bc/ward-profiles-excel-version.csv&quot;</span>, </span>
<span id="cb69-2"><a href="introduction-to-r.html#cb69-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">locale =</span> <span class="fu">locale</span>(<span class="at">encoding =</span> <span class="st">&quot;latin1&quot;</span>))</span></code></pre></div>
<p>Now run the Datatypelist code again — you should see that some of the columns (those the n/a values in) have been read in as something other than numeric. This is why we need to exclude them. Isn’t <code>readr</code> great for helping us avoid reading in our numeric data as text!</p>
<p>If you ever wish to quickly edit data, then use <code>edit()</code></p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="introduction-to-r.html#cb70-1" aria-hidden="true" tabindex="-1"></a>LondonData <span class="ot">&lt;-</span> <span class="fu">edit</span>(LondonData)</span></code></pre></div>
<ol style="list-style-type: decimal">
<li>It is also possible to quickly and easily summarise the data or look at the column headers using</li>
</ol>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="introduction-to-r.html#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(df)</span></code></pre></div>
<pre><code>##     column1          column2     
##  Min.   :  1.00   Min.   :101.0  
##  1st Qu.: 25.75   1st Qu.:125.8  
##  Median : 50.50   Median :150.5  
##  Mean   : 50.50   Mean   :150.5  
##  3rd Qu.: 75.25   3rd Qu.:175.2  
##  Max.   :100.00   Max.   :200.0</code></pre>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="introduction-to-r.html#cb73-1" aria-hidden="true" tabindex="-1"></a>LondonData<span class="sc">%&gt;%</span></span>
<span id="cb73-2"><a href="introduction-to-r.html#cb73-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>()<span class="sc">%&gt;%</span></span>
<span id="cb73-3"><a href="introduction-to-r.html#cb73-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># just look at the head, top5</span></span>
<span id="cb73-4"><a href="introduction-to-r.html#cb73-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code></pre></div>
<pre><code>## [1] &quot;Ward name&quot;                  &quot;Old code&quot;                  
## [3] &quot;New code&quot;                   &quot;Population - 2015&quot;         
## [5] &quot;Children aged 0-15 - 2015&quot;  &quot;Working-age (16-64) - 2015&quot;</code></pre>
</div>
<div id="data-manipulation-in-r" class="section level3 hasAnchor" number="2.5.5">
<h3><span class="header-section-number">2.5.5</span> Data manipulation in R<a href="introduction-to-r.html#data-manipulation-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now we have some data read into R, we need to select a small subset to work on. The first thing we will do is select just the London Boroughs to work with. If you recall, the Borough data is at the bottom of the file.</p>
<div id="selecting-rows" class="section level4 hasAnchor" number="2.5.5.1">
<h4><span class="header-section-number">2.5.5.1</span> Selecting rows<a href="introduction-to-r.html#selecting-rows" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ol style="list-style-type: decimal">
<li>Your borough data will probably be found between rows 626 and 658. Therefore we will first create a subset by selecting these rows into a new data frame and then reducing that data frame to just four columns. There are a few ways of doing this:</li>
</ol>
<p>We could select just the rows we need by explicitly specifying the range of rows we need:</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="introduction-to-r.html#cb75-1" aria-hidden="true" tabindex="-1"></a>LondonBoroughs<span class="ot">&lt;-</span>LondonData[<span class="dv">626</span><span class="sc">:</span><span class="dv">658</span>,]</span></code></pre></div>
<p>We can also do this with <code>dplyr</code>… with the <code>slice()</code> function, taking a “slice” out of the dataset…</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="introduction-to-r.html#cb76-1" aria-hidden="true" tabindex="-1"></a>LondonBoroughs<span class="ot">&lt;-</span>LondonData<span class="sc">%&gt;%</span></span>
<span id="cb76-2"><a href="introduction-to-r.html#cb76-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">626</span><span class="sc">:</span><span class="dv">658</span>)</span></code></pre></div>
<p>However, we can instead try a cool ‘data sciency’ way of pulling out the rows we want with the knowledge that the codes for London Boroughs start with E09 (the wards in the rest of the file start with E05).</p>
<p><code>dplyr</code> has a cool function called <code>filter()</code>that let’s you subset rows based on conditions…</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-106"></span>
<img src="allisonhorst_images/dplyr_filter.jpg" alt="dplyr::filter() example. Source: [Allison Horst data science and stats illustrations](https://github.com/allisonhorst/stats-illustrations)" width="500pt" />
<p class="caption">
Figure 2.6: dplyr::filter() example. Source: <a href="https://github.com/allisonhorst/stats-illustrations">Allison Horst data science and stats illustrations</a>
</p>
</div>
<p>Here, we could filter based on a variable, for example extracting all the wards where female life expextancy is greather than 90.</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="introduction-to-r.html#cb77-1" aria-hidden="true" tabindex="-1"></a>Femalelifeexp<span class="ot">&lt;-</span> LondonData <span class="sc">%&gt;%</span> </span>
<span id="cb77-2"><a href="introduction-to-r.html#cb77-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">Female life expectancy -2009-13</span><span class="st">`</span><span class="sc">&gt;</span><span class="dv">90</span>)</span></code></pre></div>
<p>However, our <code>New code</code> column that holds Borough codes can’t be filtered like this as it’s in a character format…in cases like this we can use the function <code>str_detect()</code> from the <code>stringr</code> package in combination with <code>filter()</code> from <code>dplyr</code>. Both these packages are part of the <code>tidyverse</code> again!</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="introduction-to-r.html#cb78-1" aria-hidden="true" tabindex="-1"></a>LondonBoroughs<span class="ot">&lt;-</span> LondonData <span class="sc">%&gt;%</span> </span>
<span id="cb78-2"><a href="introduction-to-r.html#cb78-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(<span class="st">`</span><span class="at">New code</span><span class="st">`</span>, <span class="st">&quot;^E09&quot;</span>))</span></code></pre></div>
<p>Check it worked:</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="introduction-to-r.html#cb79-1" aria-hidden="true" tabindex="-1"></a>LondonBoroughs<span class="sc">$</span><span class="st">`</span><span class="at">Ward name</span><span class="st">`</span></span></code></pre></div>
<p>That’s also the same as:</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="introduction-to-r.html#cb80-1" aria-hidden="true" tabindex="-1"></a>LondonBoroughs <span class="sc">%&gt;%</span> </span>
<span id="cb80-2"><a href="introduction-to-r.html#cb80-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="st">`</span><span class="at">Ward name</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb80-3"><a href="introduction-to-r.html#cb80-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code></pre></div>
<p>😎<strong>AWWMAHGAWD!!!</strong> 😎Pretty cool hey?</p>
<p>What that code is saying is <code>stringr</code> look for (detect!) the rows that have the ward code like E09, then filter these and store in the object <code>LondonBoroughs</code></p>
<p>The <code>stringr</code> package is really great and if you ever need to manipulate text type data then it’s the place to start.</p>
<p>You will notice that you will have two rows at the top for the City of London. This is because it features twice in the data set. That’s fine, extract only unique rows with <code>distinct()</code>, again from <code>dplyr</code>:</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="introduction-to-r.html#cb81-1" aria-hidden="true" tabindex="-1"></a>LondonBoroughs<span class="ot">&lt;-</span>LondonBoroughs <span class="sc">%&gt;%</span></span>
<span id="cb81-2"><a href="introduction-to-r.html#cb81-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span></code></pre></div>
</div>
<div id="selecting-columns" class="section level4 hasAnchor" number="2.5.5.2">
<h4><span class="header-section-number">2.5.5.2</span> Selecting columns<a href="introduction-to-r.html#selecting-columns" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We can select columns if we know which index we want, starting from the first column that’s 1..</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="introduction-to-r.html#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co">#select columns 1,19,20 and 21</span></span>
<span id="cb82-2"><a href="introduction-to-r.html#cb82-2" aria-hidden="true" tabindex="-1"></a>LondonBoroughs_manualcols<span class="ot">&lt;-</span>LondonBoroughs[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">19</span>,<span class="dv">20</span>,<span class="dv">21</span>)]</span></code></pre></div>
<p>We can also replicate this with <code>dplyr</code> with <code>select()</code></p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="introduction-to-r.html#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co">#select columns 1,19,20 and 21</span></span>
<span id="cb83-2"><a href="introduction-to-r.html#cb83-2" aria-hidden="true" tabindex="-1"></a>LondonBoroughs_dplyrcols<span class="ot">&lt;-</span>LondonBoroughs <span class="sc">%&gt;%</span></span>
<span id="cb83-3"><a href="introduction-to-r.html#cb83-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">19</span>,<span class="dv">20</span>,<span class="dv">21</span>))</span></code></pre></div>
<ol style="list-style-type: decimal">
<li><p>You will have noticed the use of square brackets above –– these are very useful in R. The <code>c()</code> function is also used here — this is the ‘combine’ function — another very useful function in R which allows arguments (in this case, column reference numbers) into a single value.</p></li>
<li><p>However, we could also again use a more ‘data sciency way’…selecting the columns that contain certain words …</p></li>
</ol>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="introduction-to-r.html#cb84-1" aria-hidden="true" tabindex="-1"></a>LondonBoroughs_contains<span class="ot">&lt;-</span>LondonBoroughs <span class="sc">%&gt;%</span> </span>
<span id="cb84-2"><a href="introduction-to-r.html#cb84-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">contains</span>(<span class="st">&quot;expectancy&quot;</span>), </span>
<span id="cb84-3"><a href="introduction-to-r.html#cb84-3" aria-hidden="true" tabindex="-1"></a>         <span class="fu">contains</span>(<span class="st">&quot;obese - 2011/12 to 2013/14&quot;</span>),</span>
<span id="cb84-4"><a href="introduction-to-r.html#cb84-4" aria-hidden="true" tabindex="-1"></a>         <span class="fu">contains</span>(<span class="st">&quot;Ward name&quot;</span>)) </span></code></pre></div>
</div>
<div id="renaming-columns" class="section level4 hasAnchor" number="2.5.5.3">
<h4><span class="header-section-number">2.5.5.3</span> Renaming columns<a href="introduction-to-r.html#renaming-columns" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ol style="list-style-type: decimal">
<li>You will notice that the column names are slightly misleading as we are now working with boroughs rather than wards. You probably will also be annoyed (like me!) that the column names are full of <code>...</code> that just make eveything hard to read. So, let’s rename the wards column to boroughs (using <code>rename()</code> like we did earlier), then using the <code>Janitor</code> package tidy everything up…</li>
</ol>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="introduction-to-r.html#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb85-2"><a href="introduction-to-r.html#cb85-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-3"><a href="introduction-to-r.html#cb85-3" aria-hidden="true" tabindex="-1"></a>LondonBoroughs <span class="ot">&lt;-</span> LondonBoroughs <span class="sc">%&gt;%</span></span>
<span id="cb85-4"><a href="introduction-to-r.html#cb85-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">Borough=</span><span class="st">`</span><span class="at">Ward name</span><span class="st">`</span>)<span class="sc">%&gt;%</span></span>
<span id="cb85-5"><a href="introduction-to-r.html#cb85-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>()</span></code></pre></div>
<p>By defualt <code>Janitor</code> removes all capitals and uses an underscore wherever there is a space, this would be the same as using setting the <code>case</code> argument to snake…</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-116"></span>
<img src="allisonhorst_images/janitor_clean_names.png" alt="janitor::clean_names() example. Source: [Allison Horst data science and stats illustrations](https://github.com/allisonhorst/stats-illustrations)" width="500pt" />
<p class="caption">
Figure 2.7: janitor::clean_names() example. Source: <a href="https://github.com/allisonhorst/stats-illustrations">Allison Horst data science and stats illustrations</a>
</p>
</div>
<p>If you wanted to now change it every word having a capital letter you would run…but don’t do this now.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="introduction-to-r.html#cb86-1" aria-hidden="true" tabindex="-1"></a>LondonBoroughs <span class="ot">&lt;-</span> LondonBoroughs <span class="sc">%&gt;%</span></span>
<span id="cb86-2"><a href="introduction-to-r.html#cb86-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#here the ., means all data</span></span>
<span id="cb86-3"><a href="introduction-to-r.html#cb86-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>(., <span class="at">case=</span><span class="st">&quot;big_camel&quot;</span>)</span></code></pre></div>
</div>
<div id="more-dplyr-verbs" class="section level4 hasAnchor" number="2.5.5.4">
<h4><span class="header-section-number">2.5.5.4</span> More <code>dplyr</code> verbs<a href="introduction-to-r.html#more-dplyr-verbs" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>What about determining both:</p>
<ul>
<li><ol style="list-style-type: lower-alpha">
<li>the average of male and female life expectancy together</li>
</ol></li>
<li><ol start="2" style="list-style-type: lower-alpha">
<li>a normalised value for each London borough based on the London average.</li>
</ol></li>
</ul>
<p>Then selecting only the name of the Borough, mean life expectancy and normalised life expectancy, arranging the output based on the normalised life expectancy in descending order…</p>
<p>To do this we will rely on the <code>mutate()</code> function that let’s us add new variables based on existing ones…</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-118"></span>
<img src="allisonhorst_images/dplyr_mutate.png" alt="dyplr mutate() example. Source: [Allison Horst data science and stats illustrations](https://github.com/allisonhorst/stats-illustrations)" width="500pt" />
<p class="caption">
Figure 2.8: dyplr mutate() example. Source: <a href="https://github.com/allisonhorst/stats-illustrations">Allison Horst data science and stats illustrations</a>
</p>
</div>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="introduction-to-r.html#cb87-1" aria-hidden="true" tabindex="-1"></a>Life_expectancy <span class="ot">&lt;-</span> LondonBoroughs <span class="sc">%&gt;%</span> </span>
<span id="cb87-2"><a href="introduction-to-r.html#cb87-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#new column with average of male and female life expectancy</span></span>
<span id="cb87-3"><a href="introduction-to-r.html#cb87-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">averagelifeexpectancy=</span> (female_life_expectancy_2009_13 <span class="sc">+</span></span>
<span id="cb87-4"><a href="introduction-to-r.html#cb87-4" aria-hidden="true" tabindex="-1"></a>                                       male_life_expectancy_2009_13)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">%&gt;%</span></span>
<span id="cb87-5"><a href="introduction-to-r.html#cb87-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">#new column with normalised life expectancy</span></span>
<span id="cb87-6"><a href="introduction-to-r.html#cb87-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">normalisedlifeepectancy=</span> averagelifeexpectancy <span class="sc">/</span></span>
<span id="cb87-7"><a href="introduction-to-r.html#cb87-7" aria-hidden="true" tabindex="-1"></a>           <span class="fu">mean</span>(averagelifeexpectancy))<span class="sc">%&gt;%</span></span>
<span id="cb87-8"><a href="introduction-to-r.html#cb87-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">#select only columns we want</span></span>
<span id="cb87-9"><a href="introduction-to-r.html#cb87-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(new_code,</span>
<span id="cb87-10"><a href="introduction-to-r.html#cb87-10" aria-hidden="true" tabindex="-1"></a>         borough,</span>
<span id="cb87-11"><a href="introduction-to-r.html#cb87-11" aria-hidden="true" tabindex="-1"></a>         averagelifeexpectancy, </span>
<span id="cb87-12"><a href="introduction-to-r.html#cb87-12" aria-hidden="true" tabindex="-1"></a>         normalisedlifeepectancy)<span class="sc">%&gt;%</span></span>
<span id="cb87-13"><a href="introduction-to-r.html#cb87-13" aria-hidden="true" tabindex="-1"></a>  <span class="co">#arrange in descending order</span></span>
<span id="cb87-14"><a href="introduction-to-r.html#cb87-14" aria-hidden="true" tabindex="-1"></a>  <span class="co">#ascending is the default and would be</span></span>
<span id="cb87-15"><a href="introduction-to-r.html#cb87-15" aria-hidden="true" tabindex="-1"></a>  <span class="co">#arrange(normalisedlifeepectancy)</span></span>
<span id="cb87-16"><a href="introduction-to-r.html#cb87-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(normalisedlifeepectancy))</span></code></pre></div>
<p>We can also use <code>dplyr</code> to show us the top and bottom number of rows instead of using <code>head</code> or <code>tail</code> like we did earlier.</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="introduction-to-r.html#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co">#top of data</span></span>
<span id="cb88-2"><a href="introduction-to-r.html#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="fu">slice_head</span>(Life_expectancy, <span class="at">n=</span><span class="dv">5</span>)</span></code></pre></div>
<pre><code>## # A tibble: 5 × 4
##   new_code  borough                averagelifeexpectancy normalisedlifeepectancy
##   &lt;chr&gt;     &lt;chr&gt;                                  &lt;dbl&gt;                   &lt;dbl&gt;
## 1 E09000001 City of London                          86.4                    1.05
## 2 E09000020 Kensington and Chelsea                  84.4                    1.03
## 3 E09000015 Harrow                                  84.2                    1.02
## 4 E09000027 Richmond upon Thames                    83.9                    1.02
## 5 E09000033 Westminster                             83.8                    1.02</code></pre>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="introduction-to-r.html#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co">#bottom of data</span></span>
<span id="cb90-2"><a href="introduction-to-r.html#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="fu">slice_tail</span>(Life_expectancy,<span class="at">n=</span><span class="dv">5</span>)</span></code></pre></div>
<pre><code>## # A tibble: 5 × 4
##   new_code  borough              averagelifeexpectancy normalisedlifeepectancy
##   &lt;chr&gt;     &lt;chr&gt;                                &lt;dbl&gt;                   &lt;dbl&gt;
## 1 E09000011 Greenwich                             80.8                   0.983
## 2 E09000012 Hackney                               80.7                   0.982
## 3 E09000025 Newham                                80.6                   0.980
## 4 E09000002 Barking and Dagenham                  80.1                   0.974
## 5 E09000030 Tower Hamlets                         80.0                   0.974</code></pre>
</div>
<div id="levelling-up-withdplyr" class="section level4 hasAnchor" number="2.5.5.5">
<h4><span class="header-section-number">2.5.5.5</span> Levelling up with<code>dplyr</code><a href="introduction-to-r.html#levelling-up-withdplyr" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>So far, we’ve really just covered basic operations with <code>dplyr</code> that you might have previously done in Excel. However, <code>dplyr</code> has much more powerful functions that can make advanced data wrangling a breeze. Whilst we’ve looked at life expectancy in the London boroughs relative to each other, how does the life expectancy of the London Boroughs compare the the UK average of 81.16?</p>
<p>To answer this question we can use the <code>case_when()</code>, whereby if the value is greater than 81.16 we can assign the Borough a string of “above UK average”, and if below a string of “below UK average”….</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-121"></span>
<img src="allisonhorst_images/dplyr_case_when.png" alt="dplyr case_when() example. Source: [Allison Horst data science and stats illustrations](https://github.com/allisonhorst/stats-illustrations)" width="500pt" />
<p class="caption">
Figure 2.9: dplyr case_when() example. Source: <a href="https://github.com/allisonhorst/stats-illustrations">Allison Horst data science and stats illustrations</a>
</p>
</div>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="introduction-to-r.html#cb92-1" aria-hidden="true" tabindex="-1"></a>Life_expectancy2 <span class="ot">&lt;-</span> Life_expectancy <span class="sc">%&gt;%</span></span>
<span id="cb92-2"><a href="introduction-to-r.html#cb92-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">UKcompare =</span> <span class="fu">case_when</span>(averagelifeexpectancy<span class="sc">&gt;</span><span class="fl">81.16</span> <span class="sc">~</span> <span class="st">&quot;above UK average&quot;</span>,</span>
<span id="cb92-3"><a href="introduction-to-r.html#cb92-3" aria-hidden="true" tabindex="-1"></a>                               <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&quot;below UK average&quot;</span>))</span>
<span id="cb92-4"><a href="introduction-to-r.html#cb92-4" aria-hidden="true" tabindex="-1"></a>Life_expectancy2</span></code></pre></div>
<pre><code>## # A tibble: 33 × 5
##    new_code  borough                averagelifeexpec… normalisedlifee… UKcompare
##    &lt;chr&gt;     &lt;chr&gt;                              &lt;dbl&gt;            &lt;dbl&gt; &lt;chr&gt;    
##  1 E09000001 City of London                      86.4             1.05 above UK…
##  2 E09000020 Kensington and Chelsea              84.4             1.03 above UK…
##  3 E09000015 Harrow                              84.2             1.02 above UK…
##  4 E09000027 Richmond upon Thames                83.9             1.02 above UK…
##  5 E09000033 Westminster                         83.8             1.02 above UK…
##  6 E09000007 Camden                              83.6             1.02 above UK…
##  7 E09000003 Barnet                              83.4             1.02 above UK…
##  8 E09000006 Bromley                             83.1             1.01 above UK…
##  9 E09000021 Kingston upon Thames                82.9             1.01 above UK…
## 10 E09000005 Brent                               82.4             1.00 above UK…
## # … with 23 more rows</code></pre>
<p>Now whilst this is useful, it doesn’t tell is much more about the data itself, what if we wanted to know the range of life expectancies for London Boroughs that are above the national average….</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="introduction-to-r.html#cb94-1" aria-hidden="true" tabindex="-1"></a>Life_expectancy2_group <span class="ot">&lt;-</span> Life_expectancy2 <span class="sc">%&gt;%</span></span>
<span id="cb94-2"><a href="introduction-to-r.html#cb94-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">UKdiff =</span> averagelifeexpectancy<span class="fl">-81.16</span>) <span class="sc">%&gt;%</span></span>
<span id="cb94-3"><a href="introduction-to-r.html#cb94-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(UKcompare)<span class="sc">%&gt;%</span></span>
<span id="cb94-4"><a href="introduction-to-r.html#cb94-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">range=</span><span class="fu">max</span>(UKdiff)<span class="sc">-</span><span class="fu">min</span>(UKdiff), <span class="at">count=</span><span class="fu">n</span>(), <span class="at">Average=</span><span class="fu">mean</span>(UKdiff))</span>
<span id="cb94-5"><a href="introduction-to-r.html#cb94-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-6"><a href="introduction-to-r.html#cb94-6" aria-hidden="true" tabindex="-1"></a>Life_expectancy2_group</span></code></pre></div>
<pre><code>## # A tibble: 2 × 4
##   UKcompare        range count Average
##   &lt;chr&gt;            &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt;
## 1 above UK average 5.25     25   1.52 
## 2 below UK average 0.900     8  -0.572</code></pre>
<p>This is useful, but now what if we wanted to have more information based on the distribution of the Boroughs compared to the national average, as opposed to just over or under….there are a few ways to do this..</p>
<p>We are going to:</p>
<ol style="list-style-type: decimal">
<li>Again work out difference between the life expectancy of the Boroughs compared to the national average</li>
<li>Round the whole table based on if the column is numeric (this isn’t required and we’re not adding a new column). Here we are using <code>across</code> that applies some kind of transformation across the columns selected (or that are numeric in this case).</li>
</ol>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-124"></span>
<img src="allisonhorst_images/dplyr_across.png" alt="dyplr::across() example. Source: [Allison Horst data science and stats illustrations](https://github.com/allisonhorst/stats-illustrations)" width="450pt" />
<p class="caption">
Figure 2.10: dyplr::across() example. Source: <a href="https://github.com/allisonhorst/stats-illustrations">Allison Horst data science and stats illustrations</a>
</p>
</div>
<p>Here we need to:</p>
<ol style="list-style-type: decimal">
<li>Round the column <code>UKdiff</code> to 0 decimal places (not adding a new column)</li>
<li>Use <code>case_when()</code> to find Boroughs that have an average age of equal to or over 81 and create a new column that contains text based combining <code>equal or above UK average by</code> then the years created in UKdiff. We do this through the <code>str_c()</code> function from the <code>stringr</code> package that let’s us join two or more vector elements into a single character vector. Here <code>sep</code> determines how these two vectors are separated.</li>
<li>Then group by the <code>UKcompare</code> column</li>
<li>Finally, count the number in each group.</li>
</ol>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="introduction-to-r.html#cb96-1" aria-hidden="true" tabindex="-1"></a>Life_expectancy3 <span class="ot">&lt;-</span> Life_expectancy <span class="sc">%&gt;%</span></span>
<span id="cb96-2"><a href="introduction-to-r.html#cb96-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">UKdiff =</span> averagelifeexpectancy<span class="fl">-81.16</span>)<span class="sc">%&gt;%</span></span>
<span id="cb96-3"><a href="introduction-to-r.html#cb96-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), round, <span class="dv">3</span>))<span class="sc">%&gt;%</span></span>
<span id="cb96-4"><a href="introduction-to-r.html#cb96-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(UKdiff, round, <span class="dv">0</span>))<span class="sc">%&gt;%</span></span>
<span id="cb96-5"><a href="introduction-to-r.html#cb96-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">UKcompare =</span> <span class="fu">case_when</span>(averagelifeexpectancy <span class="sc">&gt;=</span> <span class="dv">81</span> <span class="sc">~</span> </span>
<span id="cb96-6"><a href="introduction-to-r.html#cb96-6" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">str_c</span>(<span class="st">&quot;equal or above UK average by&quot;</span>,</span>
<span id="cb96-7"><a href="introduction-to-r.html#cb96-7" aria-hidden="true" tabindex="-1"></a>                                       UKdiff, </span>
<span id="cb96-8"><a href="introduction-to-r.html#cb96-8" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">&quot;years&quot;</span>, </span>
<span id="cb96-9"><a href="introduction-to-r.html#cb96-9" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">sep=</span><span class="st">&quot; &quot;</span>), </span>
<span id="cb96-10"><a href="introduction-to-r.html#cb96-10" aria-hidden="true" tabindex="-1"></a>                               <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">str_c</span>(<span class="st">&quot;below UK average by&quot;</span>,</span>
<span id="cb96-11"><a href="introduction-to-r.html#cb96-11" aria-hidden="true" tabindex="-1"></a>                                            UKdiff,</span>
<span id="cb96-12"><a href="introduction-to-r.html#cb96-12" aria-hidden="true" tabindex="-1"></a>                                            <span class="st">&quot;years&quot;</span>,</span>
<span id="cb96-13"><a href="introduction-to-r.html#cb96-13" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">sep=</span><span class="st">&quot; &quot;</span>)))<span class="sc">%&gt;%</span></span>
<span id="cb96-14"><a href="introduction-to-r.html#cb96-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(UKcompare)<span class="sc">%&gt;%</span></span>
<span id="cb96-15"><a href="introduction-to-r.html#cb96-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count=</span><span class="fu">n</span>())</span>
<span id="cb96-16"><a href="introduction-to-r.html#cb96-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-17"><a href="introduction-to-r.html#cb96-17" aria-hidden="true" tabindex="-1"></a>Life_expectancy3</span></code></pre></div>
<pre><code>## # A tibble: 7 × 2
##   UKcompare                            count
##   &lt;chr&gt;                                &lt;int&gt;
## 1 below UK average by -1 years             3
## 2 below UK average by 0 years              5
## 3 equal or above UK average by 0 years     4
## 4 equal or above UK average by 1 years    12
## 5 equal or above UK average by 2 years     4
## 6 equal or above UK average by 3 years     4
## 7 equal or above UK average by 5 years     1</code></pre>
<p>There is a lot of information here that we could use and make into a plot or map. For example, the Borough count of life expectancy difference could be visualised in a histogram (covered next week). Or, we could map the difference between the average life expectancy of each London Borough compared to the UK average..to do this would can just reuse some of the code from the example above….</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="introduction-to-r.html#cb98-1" aria-hidden="true" tabindex="-1"></a>Life_expectancy4 <span class="ot">&lt;-</span> Life_expectancy <span class="sc">%&gt;%</span></span>
<span id="cb98-2"><a href="introduction-to-r.html#cb98-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">UKdiff =</span> averagelifeexpectancy<span class="fl">-81.16</span>)<span class="sc">%&gt;%</span></span>
<span id="cb98-3"><a href="introduction-to-r.html#cb98-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(is.numeric, round, <span class="dv">3</span>))<span class="sc">%&gt;%</span></span>
<span id="cb98-4"><a href="introduction-to-r.html#cb98-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(UKdiff, round, <span class="dv">0</span>))</span></code></pre></div>
<pre><code>## Warning: Predicate functions must be wrapped in `where()`.
## 
##   # Bad
##   data %&gt;% select(is.numeric)
## 
##   # Good
##   data %&gt;% select(where(is.numeric))
## 
## ℹ Please update your code.
## This message is displayed once per session.</code></pre>
<p>Before you move on consider what you have learnt about <code>dplyr</code> in relation to this concept map. The teaching team will also explain it…</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-127"></span>
<img src="prac2_images/dplyr.svg" alt="dplyr concept map. Source: [Monica Alonso and Greg Wilson](https://github.com/rstudio/concept-maps)" width="600pt" />
<p class="caption">
Figure 2.11: dplyr concept map. Source: <a href="https://github.com/rstudio/concept-maps">Monica Alonso and Greg Wilson</a>
</p>
</div>
</div>
</div>
<div id="plotting" class="section level3 hasAnchor" number="2.5.6">
<h3><span class="header-section-number">2.5.6</span> Plotting<a href="introduction-to-r.html#plotting" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For a simple and quick plot, we can use the <code>plot()</code> function…</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="introduction-to-r.html#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(LondonBoroughs<span class="sc">$</span>male_life_expectancy_2009_13,</span>
<span id="cb100-2"><a href="introduction-to-r.html#cb100-2" aria-hidden="true" tabindex="-1"></a>     LondonBoroughs<span class="sc">$</span>percent_children_in_reception_year_who_are_obese_2011_12_to_2013_14)</span></code></pre></div>
<p><img src="CASA0005_files/figure-html/unnamed-chunk-128-1.png" width="672" /></p>
</div>
<div id="pimp-my-graph" class="section level3 hasAnchor" number="2.5.7">
<h3><span class="header-section-number">2.5.7</span> Pimp my graph!<a href="introduction-to-r.html#pimp-my-graph" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now, of course, because this is R, we can pimp this graph using something a bit more fancy than the base graphics functions. Here we will use <code>plotly</code> an open source interactive graphing library…</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="introduction-to-r.html#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;plotly&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="introduction-to-r.html#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb102-2"><a href="introduction-to-r.html#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(LondonBoroughs, </span>
<span id="cb102-3"><a href="introduction-to-r.html#cb102-3" aria-hidden="true" tabindex="-1"></a>        <span class="co">#data for x axis</span></span>
<span id="cb102-4"><a href="introduction-to-r.html#cb102-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="sc">~</span>male_life_expectancy_2009_13, </span>
<span id="cb102-5"><a href="introduction-to-r.html#cb102-5" aria-hidden="true" tabindex="-1"></a>        <span class="co">#data for y axis</span></span>
<span id="cb102-6"><a href="introduction-to-r.html#cb102-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="sc">~</span>percent_children_in_reception_year_who_are_obese_2011_12_to_2013_14, </span>
<span id="cb102-7"><a href="introduction-to-r.html#cb102-7" aria-hidden="true" tabindex="-1"></a>        <span class="co">#attribute to display when hovering </span></span>
<span id="cb102-8"><a href="introduction-to-r.html#cb102-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="sc">~</span>borough, </span>
<span id="cb102-9"><a href="introduction-to-r.html#cb102-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">type =</span> <span class="st">&quot;scatter&quot;</span>, </span>
<span id="cb102-10"><a href="introduction-to-r.html#cb102-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">mode =</span> <span class="st">&quot;markers&quot;</span>)</span></code></pre></div>
<div id="htmlwidget-9eb00c74fa71d127b56a" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-9eb00c74fa71d127b56a">{"x":{"visdat":{"31c556f4efd":["function () ","plotlyVisDat"]},"cur_data":"31c556f4efd","attrs":{"31c556f4efd":{"x":{},"y":{},"text":{},"mode":"markers","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":"male_life_expectancy_2009_13"},"yaxis":{"domain":[0,1],"automargin":true,"title":"percent_children_in_reception_year_who_are_obese_2011_12_to_2013_14","type":"category","categoryorder":"array","categoryarray":["10.2","10.3","10.6","11.0","11.1","11.2","11.5","11.6","12.2","12.5","12.7","12.8","13.2","13.3","13.6","5.7","6.0","7.8","8.1","9.0","9.2","9.5","9.6","9.8"]},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[84.3,77.7,81.9,80.3,80,81.3,81.1,80,79.9,80.6,78.7,78.2,79.1,80.1,82.4,79.8,80.4,79.7,78.2,82.6,81.3,78.4,78.7,80.3,78.5,80.7,81.9,78.6,80.8,77.5,79.7,79.2,81.7],"y":["11.1","13.6","9.5","11.6","12.2","7.8","9.8","11.1","11.2","12.7","13.2","13.3","10.2","11.1","9.6","10.3","9.6","11.2","10.6","9.2","6.0","11.5","11.0","9.0","12.5","10.6","5.7","12.8","8.1","12.7","10.6","9.2","11.1"],"text":["City of London","Barking and Dagenham","Barnet","Bexley","Brent","Bromley","Camden","Croydon","Ealing","Enfield","Greenwich","Hackney","Hammersmith and Fulham","Haringey","Harrow","Havering","Hillingdon","Hounslow","Islington","Kensington and Chelsea","Kingston upon Thames","Lambeth","Lewisham","Merton","Newham","Redbridge","Richmond upon Thames","Southwark","Sutton","Tower Hamlets","Waltham Forest","Wandsworth","Westminster"],"mode":"markers","type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="spatial-data-in-r" class="section level3 hasAnchor" number="2.5.8">
<h3><span class="header-section-number">2.5.8</span> Spatial Data in R<a href="introduction-to-r.html#spatial-data-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This next part of the practical applies the same principles introduced above to the much more complex problem of handling spatial data within R.</p>
<p>In the remainder of this practical we will produce a map, the focus here is getting to grips with some of R’s visulisation tools and not sound analysis (I know one is useless without the other!). Good quality spatial analysis will come in the rest of the module.</p>
<p>Whilst the instructions are step by step you are encouraged to start deviating from them (trying different colours for example) to get a better understanding of what we are doing.</p>
<ol style="list-style-type: decimal">
<li>The first package we need to install for this part of the practical is <code>maptools</code> –– either find and install it using the RStudio GUI or do the following:</li>
</ol>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="introduction-to-r.html#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;maptools&quot;</span>)</span></code></pre></div>
<p>There are a few other packages we’ll need to get to grips with. Some, like <code>ggplot2</code> (one of the most influential R packages ever) are part of the <code>tidyverse</code> package we came across earlier. Others we will need to install for the first time.</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="introduction-to-r.html#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="fu">c</span>(<span class="st">&quot;classInt&quot;</span>, <span class="st">&quot;tmap&quot;</span>))</span>
<span id="cb104-2"><a href="introduction-to-r.html#cb104-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-3"><a href="introduction-to-r.html#cb104-3" aria-hidden="true" tabindex="-1"></a><span class="co"># might also need these ones</span></span>
<span id="cb104-4"><a href="introduction-to-r.html#cb104-4" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="fu">c</span>(<span class="st">&quot;RColorBrewer&quot;</span>, <span class="st">&quot;sp&quot;</span>, <span class="st">&quot;rgeos&quot;</span>, </span>
<span id="cb104-5"><a href="introduction-to-r.html#cb104-5" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;tmaptools&quot;</span>, <span class="st">&quot;sf&quot;</span>, <span class="st">&quot;downloader&quot;</span>, <span class="st">&quot;rgdal&quot;</span>, </span>
<span id="cb104-6"><a href="introduction-to-r.html#cb104-6" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;geojsonio&quot;</span>))</span></code></pre></div>
<ol style="list-style-type: decimal">
<li><p>Now that the packages have been installed you will not have to repeat the above steps again (when you use your account in these cluster rooms). Open a new script and save it to your working directory as <code>wk2_maps.r</code>. As before, type each of the lines of code into this window and then select and use the ctrl return keys to run them. Be sure to save your script often.</p></li>
<li><p>The first task is to load the packages we have just installed. Note, you might have some issues with the OpenStreetMap package if your installation of java on your computer doesn’t match your installation of R –– e.g. if you have installed the 64bit version of R, you also need the 64bit version of java (same with the 32bit versions) — you may also need to install the package <code>Rcpp</code> separately and try again.</p></li>
</ol>
<p>Install Java 64-bit from: <a href="https://java.com/en/download/manual.jsp" class="uri">https://java.com/en/download/manual.jsp</a></p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="introduction-to-r.html#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Load Packages (ignore any error messages about being built under a </span></span>
<span id="cb105-2"><a href="introduction-to-r.html#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="co">#different R version):</span></span>
<span id="cb105-3"><a href="introduction-to-r.html#cb105-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(maptools)</span>
<span id="cb105-4"><a href="introduction-to-r.html#cb105-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb105-5"><a href="introduction-to-r.html#cb105-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(classInt)</span>
<span id="cb105-6"><a href="introduction-to-r.html#cb105-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sp)</span>
<span id="cb105-7"><a href="introduction-to-r.html#cb105-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rgeos)</span>
<span id="cb105-8"><a href="introduction-to-r.html#cb105-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tmap)</span>
<span id="cb105-9"><a href="introduction-to-r.html#cb105-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tmaptools)</span>
<span id="cb105-10"><a href="introduction-to-r.html#cb105-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb105-11"><a href="introduction-to-r.html#cb105-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rgdal)</span>
<span id="cb105-12"><a href="introduction-to-r.html#cb105-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(geojsonio)</span></code></pre></div>
<div id="background-to-spatial-data-in-r" class="section level4 hasAnchor" number="2.5.8.1">
<h4><span class="header-section-number">2.5.8.1</span> Background to spatial data in R<a href="introduction-to-r.html#background-to-spatial-data-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>R has a very well developed ecosystem of packages for working with Spatial Data. Early pioneers like Roger Bivand and Edzer Pebesma along with various colleagues were instrumental in writing packages to interface with some powerful open source libraries for working with spatial data, such as GDAL and GEOS. These were accessed via the <code>rgdal</code> and <code>rgeos</code> packages. The <code>maptools</code> package by Roger Bivand, amongst other things, allowed Shapefiles to be read into R. The <code>sp</code> package (along with <code>spdep</code>) by Edzer Pebesma was very important for defining a series of classes and methods for spatial data natively in R which then allowed others to write software to work with these formats. Other packages like <code>raster</code> advanced the analysis of gridded spatial data, while packages like <code>classInt</code> and <code>RColorbrewer</code> facilitated the binning of data and colouring of choropleth maps.</p>
<p>Whilst these packages were extremely important for advancing spatial data analysis in R, they were not always the most straightforward to use — making a map in R could take quite a lot of effort and they were static and visually basic. However, more recently new packages have arrived to change this. Now <code>leaflet</code> enables R to interface with the leaflet javascript library for online, dynamic maps. <code>ggplot2</code> which was developed by Hadley Wickham and colleagues radically changed the way that people thought about and created graphical objects in R, including maps, and introduced a graphical style which has been the envy of other software to the extent that there are now libraries in Python which copy the <code>ggplot2</code> style!</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-134"></span>
<img src="allisonhorst_images/ggplot2_exploratory.png" alt="ggplot2 introduction graphic. Source: [Allison Horst data science and stats illustrations](https://github.com/allisonhorst/stats-illustrations)" width="450pt" />
<p class="caption">
Figure 2.12: ggplot2 introduction graphic. Source: <a href="https://github.com/allisonhorst/stats-illustrations">Allison Horst data science and stats illustrations</a>
</p>
</div>
<p>Building on all of these, the new <code>tmap</code> (Thematic Map) package has changed the game completely and now enables us to read, write and manipulate spatial data and produce visually impressive and interactive maps, very easily. In parallel, the <code>sf</code> (Simple Features) package is helping us re-think the way that spatial data can be stored and manipulated. It’s exciting times for geographic information / spatial data science!</p>
</div>
<div id="making-some-choropleth-maps" class="section level4 hasAnchor" number="2.5.8.2">
<h4><span class="header-section-number">2.5.8.2</span> Making some choropleth maps<a href="introduction-to-r.html#making-some-choropleth-maps" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Choropleth maps are thematic maps which colour areas according to some phenomenon. In our case, we are going to fill some irregular polygons (the London Boroughs) with a colour that corresponds to a particular attribute.</p>
<p>As with all plots in R, there are multiple ways we can do this. The basic <code>plot()</code> function requires no data preparation but additional effort in colour selection/ adding the map key etc. Quick plot (<code>qplot()</code>) and <code>ggplot()</code> (installed in the <code>ggplot2</code> package, part of the <code>tidyverse</code>) require some additional steps to format the spatial data but select colours and add keys etc automatically. Qplot is basically a shortcut for a quick map / plot, but if you have a lot of data use <code>ggplot()</code>. However, here, we are going to make use of the new <code>tmap</code> package which makes making maps very easy indeed. More on <code>tmap</code> when we start mapping..</p>
<ol style="list-style-type: decimal">
<li><p>So one mega cool thing about R is you can read spatial data in straight from the internetz! Try this below for downloading a GeoJson file…it might take a few minutes…</p></li>
<li><p>You can also either</p></li>
</ol>
<ul>
<li><ol style="list-style-type: lower-alpha">
<li><a href="https://opendata.arcgis.com/datasets/8edafbe3276d4b56aec60991cbddda50_2.geojson">Download the geojson file</a></li>
</ol></li>
<li><ol start="2" style="list-style-type: lower-alpha">
<li><a href="https://opendata.arcgis.com/datasets/8edafbe3276d4b56aec60991cbddda50_2.zip?outSR=%7B%22latestWkid%22%3A27700%2C%22wkid%22%3A27700%7D">Download the shapefile</a>from the <a href="http://geoportal.statistics.gov.uk/datasets/8edafbe3276d4b56aec60991cbddda50_2">Office for National Statistics Open Geography Portal</a></li>
</ol></li>
</ul>
<p>Move either to your project folder and read it in. The <code>.shp</code> is normally quicker to load.</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="introduction-to-r.html#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co"># this will take a few minutes</span></span>
<span id="cb106-2"><a href="introduction-to-r.html#cb106-2" aria-hidden="true" tabindex="-1"></a>EW <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">&quot;https://opendata.arcgis.com/datasets/8edafbe3276d4b56aec60991cbddda50_2.geojson&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="introduction-to-r.html#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co"># this will take a few minutes</span></span>
<span id="cb107-2"><a href="introduction-to-r.html#cb107-2" aria-hidden="true" tabindex="-1"></a><span class="co"># geojson in local folder</span></span>
<span id="cb107-3"><a href="introduction-to-r.html#cb107-3" aria-hidden="true" tabindex="-1"></a><span class="co">#EW &lt;- st_read(here::here(&quot;prac2_data&quot;,</span></span>
<span id="cb107-4"><a href="introduction-to-r.html#cb107-4" aria-hidden="true" tabindex="-1"></a><span class="co">#                         &quot;Local_Authority_Districts__December_2015__Boundaries.geojson&quot;))</span></span>
<span id="cb107-5"><a href="introduction-to-r.html#cb107-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-6"><a href="introduction-to-r.html#cb107-6" aria-hidden="true" tabindex="-1"></a><span class="co"># shapefile in local folder</span></span>
<span id="cb107-7"><a href="introduction-to-r.html#cb107-7" aria-hidden="true" tabindex="-1"></a>EW <span class="ot">&lt;-</span> <span class="fu">st_read</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;prac2_data&quot;</span>,</span>
<span id="cb107-8"><a href="introduction-to-r.html#cb107-8" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&quot;Local_Authority_Districts_(December_2015)_Boundaries&quot;</span>,</span>
<span id="cb107-9"><a href="introduction-to-r.html#cb107-9" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&quot;Local_Authority_Districts_(December_2015)_Boundaries.shp&quot;</span>))</span></code></pre></div>
<pre><code>## Reading layer `Local_Authority_Districts_(December_2015)_Boundaries&#39; from data source `C:\Users\Andy\OneDrive - University College London\Teaching\CASA0005\2020_2021\CASA0005repo\prac2_data\Local_Authority_Districts_(December_2015)_Boundaries\Local_Authority_Districts_(December_2015)_Boundaries.shp&#39; 
##   using driver `ESRI Shapefile&#39;
## Simple feature collection with 380 features and 6 fields
## Geometry type: MULTIPOLYGON
## Dimension:     XY
## Bounding box:  xmin: 5513 ymin: 5333.602 xmax: 655989 ymax: 1220302
## Projected CRS: OSGB 1936 / British National Grid</code></pre>
<p>Pull out London using the <code>str_detect()</code> function from the <code>stringr</code> package in combination with <code>filter()</code> from <code>dplyr</code> (again!). We will look for the bit of the district code that relates to London (E09) from the ‘lad15cd’ column data frame of our <code>sf</code> object.</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="introduction-to-r.html#cb109-1" aria-hidden="true" tabindex="-1"></a>LondonMap<span class="ot">&lt;-</span> EW <span class="sc">%&gt;%</span></span>
<span id="cb109-2"><a href="introduction-to-r.html#cb109-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(lad15cd, <span class="st">&quot;^E09&quot;</span>))</span>
<span id="cb109-3"><a href="introduction-to-r.html#cb109-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-4"><a href="introduction-to-r.html#cb109-4" aria-hidden="true" tabindex="-1"></a><span class="co">#plot it using the qtm function</span></span>
<span id="cb109-5"><a href="introduction-to-r.html#cb109-5" aria-hidden="true" tabindex="-1"></a><span class="fu">qtm</span>(LondonMap)</span></code></pre></div>
<p><img src="CASA0005_files/figure-html/unnamed-chunk-137-1.png" width="672" /></p>
</div>
<div id="attribute-data" class="section level4 hasAnchor" number="2.5.8.3">
<h4><span class="header-section-number">2.5.8.3</span> Attribute data<a href="introduction-to-r.html#attribute-data" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>OK, enough messing around, show us the maps!!</p>
<ol style="list-style-type: decimal">
<li>Hold your horses, before be can create a map, we need to join some attribute data to some boundaries, let’s do it with <code>merge()</code>, but first clean up all of our names with <code>Janitor</code> again.</li>
</ol>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="introduction-to-r.html#cb110-1" aria-hidden="true" tabindex="-1"></a>LondonData <span class="ot">&lt;-</span> <span class="fu">clean_names</span>(LondonData)</span>
<span id="cb110-2"><a href="introduction-to-r.html#cb110-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-3"><a href="introduction-to-r.html#cb110-3" aria-hidden="true" tabindex="-1"></a><span class="co">#EW is the data we read in straight from the web</span></span>
<span id="cb110-4"><a href="introduction-to-r.html#cb110-4" aria-hidden="true" tabindex="-1"></a>BoroughDataMap <span class="ot">&lt;-</span> EW <span class="sc">%&gt;%</span></span>
<span id="cb110-5"><a href="introduction-to-r.html#cb110-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>()<span class="sc">%&gt;%</span></span>
<span id="cb110-6"><a href="introduction-to-r.html#cb110-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># the . here just means use the data already loaded</span></span>
<span id="cb110-7"><a href="introduction-to-r.html#cb110-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(lad15cd, <span class="st">&quot;^E09&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb110-8"><a href="introduction-to-r.html#cb110-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">merge</span>(.,</span>
<span id="cb110-9"><a href="introduction-to-r.html#cb110-9" aria-hidden="true" tabindex="-1"></a>        LondonData, </span>
<span id="cb110-10"><a href="introduction-to-r.html#cb110-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">by.x=</span><span class="st">&quot;lad15cd&quot;</span>, </span>
<span id="cb110-11"><a href="introduction-to-r.html#cb110-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">by.y=</span><span class="st">&quot;new_code&quot;</span>,</span>
<span id="cb110-12"><a href="introduction-to-r.html#cb110-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">no.dups =</span> <span class="cn">TRUE</span>)<span class="sc">%&gt;%</span></span>
<span id="cb110-13"><a href="introduction-to-r.html#cb110-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(.,lad15cd, </span>
<span id="cb110-14"><a href="introduction-to-r.html#cb110-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">.keep_all =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>We’ve added some more arguments to <code>distinct()</code> that mean we only have unique rows based on the code, but we keep all other variables <code>.keep_all=TRUE</code>. If you change to <code>.keep_all=FALSE</code> (which is the default) then all the other variables will be removed.</p>
<p>An alternative to <code>merge()</code> would be to use a <code>left_join()</code> (like in SQL)…but it’s the same thing as <code>merge()</code>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-139"></span>
<img src="prac2_images/sql-joins.png" alt="SQL join types. Source: [SQL Join Diagram, dofactory](https://www.dofactory.com/sql/join)" width="500px" />
<p class="caption">
Figure 2.13: SQL join types. Source: <a href="https://www.dofactory.com/sql/join">SQL Join Diagram, dofactory</a>
</p>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-140"></span>
<img src="prac2_images/left-join.gif" alt="dplyr::left_join() example. Source: [Tidy explain by Garrick Aden‑Buie](https://www.garrickadenbuie.com/project/tidyexplain/)" width="500px" />
<p class="caption">
Figure 2.14: dplyr::left_join() example. Source: <a href="https://www.garrickadenbuie.com/project/tidyexplain/">Tidy explain by Garrick Aden‑Buie</a>
</p>
</div>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="introduction-to-r.html#cb111-1" aria-hidden="true" tabindex="-1"></a>BoroughDataMap2 <span class="ot">&lt;-</span> EW <span class="sc">%&gt;%</span> </span>
<span id="cb111-2"><a href="introduction-to-r.html#cb111-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span></span>
<span id="cb111-3"><a href="introduction-to-r.html#cb111-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(lad15cd, <span class="st">&quot;^E09&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb111-4"><a href="introduction-to-r.html#cb111-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(., </span>
<span id="cb111-5"><a href="introduction-to-r.html#cb111-5" aria-hidden="true" tabindex="-1"></a>            LondonData,</span>
<span id="cb111-6"><a href="introduction-to-r.html#cb111-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;lad15cd&quot;</span> <span class="ot">=</span> <span class="st">&quot;new_code&quot;</span>))</span></code></pre></div>
<p>If there are mutliple matches then all hits are returned…</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-142"></span>
<img src="prac2_images/left-join-extra.gif" alt="dplyr::left_join() example with multiple matches. Source: [Tidy explain by Garrick Aden‑Buie](https://www.garrickadenbuie.com/project/tidyexplain/)" width="500px" />
<p class="caption">
Figure 2.15: dplyr::left_join() example with multiple matches. Source: <a href="https://www.garrickadenbuie.com/project/tidyexplain/">Tidy explain by Garrick Aden‑Buie</a>
</p>
</div>
<p>However, i’ve left out <code>filter()</code> and <code>distinct()</code> which you would need to reduce the data to London and remove the duplicate City of London row afterwards…like in the step before with <code>merge</code> and as we did earlier on in the session.</p>
</div>
</div>
<div id="simple-mapping" class="section level3 hasAnchor" number="2.5.9">
<h3><span class="header-section-number">2.5.9</span> Simple mapping<a href="introduction-to-r.html#simple-mapping" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>tmap</code> follows the idea of the grammar of graphics, similar to <code>dplyr</code> being the grammar of data manipulation. Essentially with the grammar of graphics the main data being mapped defines the location somewhere on Earth (loaded with <code>tm_shape</code>). Map aesthetics are then defined with a <code>+</code>, these usually include <code>tm_fill()</code> (fill of the polygons based on a variable) + <code>tm_borders()</code> (border of polygons). However, <code>tm_polygon</code> basically combines <code>tm_fill()</code> and <code>tm_borders()</code>…</p>
<p>So to conclude, data first then <code>+</code> aesthetic syntax.</p>
<p>We’re going to create a simple map with our spatial data, mapping and cartographic practice are covered in much more detail later in the course, but for now…</p>
<ol style="list-style-type: decimal">
<li>We can create a choropleth map very quickly now using <code>qtm()</code> as we’ve done before</li>
</ol>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="introduction-to-r.html#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tmap)</span>
<span id="cb112-2"><a href="introduction-to-r.html#cb112-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tmaptools)</span>
<span id="cb112-3"><a href="introduction-to-r.html#cb112-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">&quot;plot&quot;</span>)</span>
<span id="cb112-4"><a href="introduction-to-r.html#cb112-4" aria-hidden="true" tabindex="-1"></a><span class="fu">qtm</span>(BoroughDataMap, </span>
<span id="cb112-5"><a href="introduction-to-r.html#cb112-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;rate_of_job_seekers_allowance_jsa_claimants_2015&quot;</span>)</span></code></pre></div>
<p><img src="CASA0005_files/figure-html/unnamed-chunk-143-1.png" width="672" /></p>
<p>But that’s a bit basic! How about adding a basemap…to get a basemap we need to extract it from OpenStreetMap (OSM) using the <code>read_osm()</code> function from the <code>tmaptools</code> package. We talk about this in later weeks, but it’s a free editable map of the World (the Wikipedia of maps). We are going to need to create a box (termed bounding box) around London using the <code>st_box()</code> function from the <code>sf</code> package to extract the basemap image (which is a raster).</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="introduction-to-r.html#cb113-1" aria-hidden="true" tabindex="-1"></a>tmaplondon <span class="ot">&lt;-</span> BoroughDataMap <span class="sc">%&gt;%</span></span>
<span id="cb113-2"><a href="introduction-to-r.html#cb113-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_bbox</span>(.) <span class="sc">%&gt;%</span> </span>
<span id="cb113-3"><a href="introduction-to-r.html#cb113-3" aria-hidden="true" tabindex="-1"></a>  tmaptools<span class="sc">::</span><span class="fu">read_osm</span>(., <span class="at">type =</span> <span class="st">&quot;osm&quot;</span>, <span class="at">zoom =</span> <span class="cn">NULL</span>)</span></code></pre></div>
<p>Now we have the basemap, set <code>tmap</code> to plot, add the basemap, add the shape (our London layer), tell it which attribute to map (job seekers), the style to make the colour divisions (we explain this more in later weeks), the transparency (alpha), compass, scale and legend.</p>
<p>But remember what i explained earlier… data first then <code>+</code> aesthetic syntax. We can also double up on this, so below we have data data from our bounding box + it’s raster aesthetic (<code>tm_rgb</code>) THEN ALSO the data from our London Borough layer and it’s aesthetics. As they are the same place they plot over each other!</p>
<p>There is a bit of extra code below that we haven’t explained:</p>
<ul>
<li><code>style</code> — how to divide the data into out colour breaks</li>
<li><code>palette</code> — the colour scheme to use</li>
</ul>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="introduction-to-r.html#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">&quot;plot&quot;</span>)</span>
<span id="cb114-2"><a href="introduction-to-r.html#cb114-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-3"><a href="introduction-to-r.html#cb114-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(tmaplondon)<span class="sc">+</span></span>
<span id="cb114-4"><a href="introduction-to-r.html#cb114-4" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_rgb</span>()<span class="sc">+</span></span>
<span id="cb114-5"><a href="introduction-to-r.html#cb114-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(BoroughDataMap) <span class="sc">+</span> </span>
<span id="cb114-6"><a href="introduction-to-r.html#cb114-6" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_polygons</span>(<span class="st">&quot;rate_of_job_seekers_allowance_jsa_claimants_2015&quot;</span>, </span>
<span id="cb114-7"><a href="introduction-to-r.html#cb114-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">style=</span><span class="st">&quot;jenks&quot;</span>,</span>
<span id="cb114-8"><a href="introduction-to-r.html#cb114-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">palette=</span><span class="st">&quot;YlOrBr&quot;</span>,</span>
<span id="cb114-9"><a href="introduction-to-r.html#cb114-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">midpoint=</span><span class="cn">NA</span>,</span>
<span id="cb114-10"><a href="introduction-to-r.html#cb114-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">title=</span><span class="st">&quot;Rate per 1,000 people&quot;</span>,</span>
<span id="cb114-11"><a href="introduction-to-r.html#cb114-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb114-12"><a href="introduction-to-r.html#cb114-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_compass</span>(<span class="at">position =</span> <span class="fu">c</span>(<span class="st">&quot;left&quot;</span>, <span class="st">&quot;bottom&quot;</span>),<span class="at">type =</span> <span class="st">&quot;arrow&quot;</span>) <span class="sc">+</span> </span>
<span id="cb114-13"><a href="introduction-to-r.html#cb114-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_scale_bar</span>(<span class="at">position =</span> <span class="fu">c</span>(<span class="st">&quot;left&quot;</span>, <span class="st">&quot;bottom&quot;</span>)) <span class="sc">+</span></span>
<span id="cb114-14"><a href="introduction-to-r.html#cb114-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">title =</span> <span class="st">&quot;Job seekers&#39; Allowance Claimants&quot;</span>, <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="st">&quot;right&quot;</span>, <span class="st">&quot;bottom&quot;</span>))</span></code></pre></div>
<p>For more palette options, run <code>palette_explorer()</code> in the console.</p>
<p>So that’s our first real map done! Awesome work. But remember our <code>Life_expectancy4</code> data that we wrangled earlier. Can you think of a way to map this? So we need to</p>
<ol style="list-style-type: decimal">
<li>Merge our <code>Life_expectancy4map</code> with the spatial data <code>EW</code></li>
<li>Map our merge with <code>tmap</code></li>
</ol>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="introduction-to-r.html#cb115-1" aria-hidden="true" tabindex="-1"></a>Life_expectancy4map <span class="ot">&lt;-</span> EW <span class="sc">%&gt;%</span></span>
<span id="cb115-2"><a href="introduction-to-r.html#cb115-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">merge</span>(.,</span>
<span id="cb115-3"><a href="introduction-to-r.html#cb115-3" aria-hidden="true" tabindex="-1"></a>        Life_expectancy4, </span>
<span id="cb115-4"><a href="introduction-to-r.html#cb115-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">by.x=</span><span class="st">&quot;lad15cd&quot;</span>, </span>
<span id="cb115-5"><a href="introduction-to-r.html#cb115-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">by.y=</span><span class="st">&quot;new_code&quot;</span>,</span>
<span id="cb115-6"><a href="introduction-to-r.html#cb115-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">no.dups =</span> <span class="cn">TRUE</span>)<span class="sc">%&gt;%</span></span>
<span id="cb115-7"><a href="introduction-to-r.html#cb115-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(.,lad15cd, </span>
<span id="cb115-8"><a href="introduction-to-r.html#cb115-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">.keep_all =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>Now let’s make the map!</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="introduction-to-r.html#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">&quot;plot&quot;</span>)</span>
<span id="cb116-2"><a href="introduction-to-r.html#cb116-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-3"><a href="introduction-to-r.html#cb116-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(tmaplondon)<span class="sc">+</span></span>
<span id="cb116-4"><a href="introduction-to-r.html#cb116-4" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_rgb</span>()<span class="sc">+</span></span>
<span id="cb116-5"><a href="introduction-to-r.html#cb116-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(Life_expectancy4map) <span class="sc">+</span> </span>
<span id="cb116-6"><a href="introduction-to-r.html#cb116-6" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_polygons</span>(<span class="st">&quot;UKdiff&quot;</span>, </span>
<span id="cb116-7"><a href="introduction-to-r.html#cb116-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">style=</span><span class="st">&quot;pretty&quot;</span>,</span>
<span id="cb116-8"><a href="introduction-to-r.html#cb116-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">palette=</span><span class="st">&quot;Blues&quot;</span>,</span>
<span id="cb116-9"><a href="introduction-to-r.html#cb116-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">midpoint=</span><span class="cn">NA</span>,</span>
<span id="cb116-10"><a href="introduction-to-r.html#cb116-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">title=</span><span class="st">&quot;Number of years&quot;</span>,</span>
<span id="cb116-11"><a href="introduction-to-r.html#cb116-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb116-12"><a href="introduction-to-r.html#cb116-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_compass</span>(<span class="at">position =</span> <span class="fu">c</span>(<span class="st">&quot;left&quot;</span>, <span class="st">&quot;bottom&quot;</span>),<span class="at">type =</span> <span class="st">&quot;arrow&quot;</span>) <span class="sc">+</span> </span>
<span id="cb116-13"><a href="introduction-to-r.html#cb116-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_scale_bar</span>(<span class="at">position =</span> <span class="fu">c</span>(<span class="st">&quot;left&quot;</span>, <span class="st">&quot;bottom&quot;</span>)) <span class="sc">+</span></span>
<span id="cb116-14"><a href="introduction-to-r.html#cb116-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">title =</span> <span class="st">&quot;Difference in life expectancy&quot;</span>, <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="st">&quot;right&quot;</span>, <span class="st">&quot;bottom&quot;</span>))</span></code></pre></div>
<p><img src="CASA0005_files/figure-html/unnamed-chunk-147-1.png" width="672" /></p>
<p>There are a few subtle differences in the code of this second map if you look closely:</p>
<ul>
<li><p>Style is now <code>pretty</code> not <code>jenks</code>. Style controls where the breaks are within the data that are then assigned to each colour for mapping. <code>pretty</code> rounds to whole numbers and evenly spaces them over the data.</p></li>
<li><p>Palette in now <code>Blues</code> not <code>YlOrBr</code>. Palette controls the colour of the map, you can see more options through <code>tmaptools::palette_explorer()</code></p></li>
</ul>
</div>
</div>
<div id="tidying-data" class="section level2 hasAnchor" number="2.6">
<h2><span class="header-section-number">2.6</span> Tidying data<a href="introduction-to-r.html#tidying-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>As you progress through the programme you will probably notice that there is pretty much a tool or function for anything you could want. However, there has been little reserach into creating a standardised approach for wrangling data into a common format for analysis. This is where <a href="https://www.jstatsoft.org/article/view/v059i10">Hadley Wickham’s tidy data comes in</a>. As per the <a href="https://r4ds.had.co.nz/tidy-data.html">R for Data Science book</a>, tidy data is defined using the following three rules:</p>
<ol style="list-style-type: decimal">
<li><p>Each variable must have its own column.</p></li>
<li><p>Each observation must have its own row.</p></li>
<li><p>Each value must have its own cell.</p></li>
</ol>
<p>But, as per the book, these three requirements are interrelated as you can’t only adhere to two without adhering to all three. So this gives us:</p>
<ol style="list-style-type: decimal">
<li><p>Put each dataset in a tibble</p></li>
<li><p>Put each variable in a column</p></li>
</ol>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-148"></span>
<img src="prac2_images/tidy-1.png" alt="This figure is taken directly from Grolemund and Wickham (2017) Chapter 12.Following three rules makes a dataset tidy: variables are in columns, observations are in rows, and values are in cells." width="500px" />
<p class="caption">
Figure 2.16: This figure is taken directly from Grolemund and Wickham (2017) Chapter 12.Following three rules makes a dataset tidy: variables are in columns, observations are in rows, and values are in cells.
</p>
</div>
<p>However, i also find this example from <a href="https://www.ksk-anl.com/blog/hadley-wickhams-tidy-data-in-rapidminer-part-1/">KSK analytics</a> very helpful..</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-149"></span>
<img src="prac2_images/messy-tidy-ex.png" alt="This figure is taken directly from Grolemund and Wickham (2017) Chapter 12.Following three rules makes a dataset tidy: variables are in columns, observations are in rows, and values are in cells." width="500px" />
<p class="caption">
Figure 2.17: This figure is taken directly from Grolemund and Wickham (2017) Chapter 12.Following three rules makes a dataset tidy: variables are in columns, observations are in rows, and values are in cells.
</p>
</div>
<p>Earlier we read in the data using:</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="introduction-to-r.html#cb117-1" aria-hidden="true" tabindex="-1"></a>flytipping <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;https://data.london.gov.uk/download/fly-tipping-incidents/536278ff-a391-4f20-bc79-9e705c9b3ec0/fly-tipping-borough.csv&quot;</span>)</span></code></pre></div>
<p>But we can also do something like this to force the columns to the appopraite data types (e.g. text, numberic)</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="introduction-to-r.html#cb118-1" aria-hidden="true" tabindex="-1"></a>flytipping1 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;https://data.london.gov.uk/download/fly-tipping-incidents/536278ff-a391-4f20-bc79-9e705c9b3ec0/fly-tipping-borough.csv&quot;</span>, </span>
<span id="cb118-2"><a href="introduction-to-r.html#cb118-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">col_types =</span> <span class="fu">cols</span>(</span>
<span id="cb118-3"><a href="introduction-to-r.html#cb118-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">code =</span> <span class="fu">col_character</span>(),</span>
<span id="cb118-4"><a href="introduction-to-r.html#cb118-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">area =</span> <span class="fu">col_character</span>(),</span>
<span id="cb118-5"><a href="introduction-to-r.html#cb118-5" aria-hidden="true" tabindex="-1"></a>                         <span class="at">year =</span> <span class="fu">col_character</span>(),</span>
<span id="cb118-6"><a href="introduction-to-r.html#cb118-6" aria-hidden="true" tabindex="-1"></a>                         <span class="at">total_incidents =</span> <span class="fu">col_number</span>(),</span>
<span id="cb118-7"><a href="introduction-to-r.html#cb118-7" aria-hidden="true" tabindex="-1"></a>                         <span class="at">total_action_taken =</span> <span class="fu">col_number</span>(),</span>
<span id="cb118-8"><a href="introduction-to-r.html#cb118-8" aria-hidden="true" tabindex="-1"></a>                         <span class="at">warning_letters =</span> <span class="fu">col_number</span>(),</span>
<span id="cb118-9"><a href="introduction-to-r.html#cb118-9" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fixed_penalty_notices =</span> <span class="fu">col_number</span>(),</span>
<span id="cb118-10"><a href="introduction-to-r.html#cb118-10" aria-hidden="true" tabindex="-1"></a>                         <span class="at">statutory_notices =</span> <span class="fu">col_number</span>(),</span>
<span id="cb118-11"><a href="introduction-to-r.html#cb118-11" aria-hidden="true" tabindex="-1"></a>                         <span class="at">formal_cautions =</span> <span class="fu">col_number</span>(),</span>
<span id="cb118-12"><a href="introduction-to-r.html#cb118-12" aria-hidden="true" tabindex="-1"></a>                         <span class="at">injunctions =</span> <span class="fu">col_number</span>(),</span>
<span id="cb118-13"><a href="introduction-to-r.html#cb118-13" aria-hidden="true" tabindex="-1"></a>                         <span class="at">prosecutions =</span> <span class="fu">col_number</span>()</span>
<span id="cb118-14"><a href="introduction-to-r.html#cb118-14" aria-hidden="true" tabindex="-1"></a>                       ))</span>
<span id="cb118-15"><a href="introduction-to-r.html#cb118-15" aria-hidden="true" tabindex="-1"></a><span class="co"># view the data</span></span>
<span id="cb118-16"><a href="introduction-to-r.html#cb118-16" aria-hidden="true" tabindex="-1"></a><span class="fu">view</span>(flytipping1)</span></code></pre></div>
<p>So we have a tibble with columns of each varaible (e.g. warning letters, total actions taken) where every row is a London borough. We want make sure that each observation has its own row…it doesn’t as in the first row here we have observations for total incidents and total actions taken etc…to do this we will use <code>pivot_longer()</code>. Make sure you have the most recent version of <code>tidyverse</code> if you get an error.</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="introduction-to-r.html#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="co">#convert the tibble into a tidy tibble</span></span>
<span id="cb119-2"><a href="introduction-to-r.html#cb119-2" aria-hidden="true" tabindex="-1"></a>flytipping_long <span class="ot">&lt;-</span> flytipping1 <span class="sc">%&gt;%</span> </span>
<span id="cb119-3"><a href="introduction-to-r.html#cb119-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb119-4"><a href="introduction-to-r.html#cb119-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">cols =</span> <span class="dv">4</span><span class="sc">:</span><span class="dv">11</span>,</span>
<span id="cb119-5"><a href="introduction-to-r.html#cb119-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">names_to =</span> <span class="st">&quot;tipping_type&quot;</span>,</span>
<span id="cb119-6"><a href="introduction-to-r.html#cb119-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">values_to =</span> <span class="st">&quot;count&quot;</span></span>
<span id="cb119-7"><a href="introduction-to-r.html#cb119-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb119-8"><a href="introduction-to-r.html#cb119-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-9"><a href="introduction-to-r.html#cb119-9" aria-hidden="true" tabindex="-1"></a><span class="co"># view the data</span></span>
<span id="cb119-10"><a href="introduction-to-r.html#cb119-10" aria-hidden="true" tabindex="-1"></a><span class="fu">view</span>(flytipping_long)</span></code></pre></div>
<p>Do you see the difference..the data has become longer!…this is classed as tidy data as every variable has a column, every observation has a row and every value has a cell.</p>
<p>You could also use this to do the same thing…</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="introduction-to-r.html#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="co">#an alternative which just pulls everything out into a single table</span></span>
<span id="cb120-2"><a href="introduction-to-r.html#cb120-2" aria-hidden="true" tabindex="-1"></a>flytipping2 <span class="ot">&lt;-</span> flytipping1[,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]</span></code></pre></div>
<p>But my advice would be to learn how to use the tidy tools!</p>
<p>Now let’s make it a bit more suitable for mapping with <code>pivot_wider()</code> by making coloumns for each year of each variable….in the original <code>.csv</code> we had a year coloumn that had values of 2011-2012 to 2017-2018, so if we wanted to map a specifc year we’d have to filter out the year then map. Here we can just alter the data from <code>pivot_longer()</code> using the year and tipping type…</p>
<blockquote>
<p>Note, just because the data is considered tidy doesn’t mean it is directly appropriate for mapping. It might need to be tidy for analysis.</p>
</blockquote>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="introduction-to-r.html#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="co">#pivot the tidy tibble into one that is suitable for mapping</span></span>
<span id="cb121-2"><a href="introduction-to-r.html#cb121-2" aria-hidden="true" tabindex="-1"></a>flytipping_wide <span class="ot">&lt;-</span> flytipping_long <span class="sc">%&gt;%</span> </span>
<span id="cb121-3"><a href="introduction-to-r.html#cb121-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb121-4"><a href="introduction-to-r.html#cb121-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">id_cols =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,</span>
<span id="cb121-5"><a href="introduction-to-r.html#cb121-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">names_from =</span> <span class="fu">c</span>(year,tipping_type),</span>
<span id="cb121-6"><a href="introduction-to-r.html#cb121-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">names_sep =</span> <span class="st">&quot;_&quot;</span>,</span>
<span id="cb121-7"><a href="introduction-to-r.html#cb121-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">values_from =</span> count</span>
<span id="cb121-8"><a href="introduction-to-r.html#cb121-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb121-9"><a href="introduction-to-r.html#cb121-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-10"><a href="introduction-to-r.html#cb121-10" aria-hidden="true" tabindex="-1"></a><span class="fu">view</span>(flytipping_wide)</span></code></pre></div>
<p>But what if you were just interested in a specific varaible and wanted the coloums to be each year of the data…again using <code>pivot_wider()</code></p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="introduction-to-r.html#cb122-1" aria-hidden="true" tabindex="-1"></a>widefly <span class="ot">&lt;-</span> flytipping2 <span class="sc">%&gt;%</span> </span>
<span id="cb122-2"><a href="introduction-to-r.html#cb122-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb122-3"><a href="introduction-to-r.html#cb122-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">names_from =</span> year, </span>
<span id="cb122-4"><a href="introduction-to-r.html#cb122-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">values_from =</span> total_incidents)</span></code></pre></div>
<p>You could now join this to the London borough <code>.shp</code> and produce a map…</p>
<p>For another quick worked example have a look at the <a href="https://rladiessydney.org/courses/ryouwithme/02-cleanitup-5/">RLadies Sydney blog post on pivoting</a></p>
<p>What’s the take home from this? Basically always try to put your data into a certain format before doing further analysis on it as it will be easier for you to determine the right tools to select.</p>
</div>
<div id="feedback-1" class="section level2 hasAnchor" number="2.7">
<h2><span class="header-section-number">2.7</span> Feedback<a href="introduction-to-r.html#feedback-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Was anything that we explained unclear this week or was something really clear…let us know using the <a href="https://forms.gle/w2GUDYc7tSavGy7r6">feedback form</a>. It’s anonymous and we’ll use the responses to clear any issues up in the future / adapt the material.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="geographic-information.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="spatial-descriptive-statistics.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/andrewmaclachlan/CASA0005repo/edit/master/02-prac2.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["https://github.com/andrewmaclachlan/CASA0005repo/raw/master/02-prac2.Rmd"],
"search": {
"engine": "fuse",
"options": {
"includeScore": true
}
},
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
